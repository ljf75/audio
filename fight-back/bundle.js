!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const r={"\0":15656e3,"":7079616,"@":6929286,0:6990528,1:4998208,2:12732640,3:12731072,4:11199008,5:15254208,6:6875872,7:14829696,8:15395552,9:15393472,A:4909728,B:13290176,C:6850656,D:13281984,E:15263968,F:15263872,G:6875744,H:11201184,I:14959840,J:2239040,K:11192992,L:8947936,M:11463328,N:11464352,O:4893248,P:13289600,Q:4893280,R:13290144,S:6832832,T:14959680,U:11184736,V:11183168,W:11202208,X:11160224,Y:11158592,Z:14829792,a:813792,b:9218752,c:428128,d:2533984,e:437344,f:2417728,g:437796,h:9218720,i:4211776,j:2106020,k:9096352,l:12862688,m:978592,n:830112,o:305728,p:830152,q:436834,r:428160,s:444096,t:5129312,u:698976,v:699968,w:716512,x:672928,y:697892,z:945376,".":64,"!":4472896,'"':11141120,"?":14827584,"|":4473924,"+":20032,"-":3584,"/":2246784,":":16448,"(":4753472,")":8668288};var s,h,n,o;!function(t){t.BLACK="rgb(20, 12, 28)",t.DARK_VIOLET="rgb(68, 36, 52)",t.DARK_BLUE="rgb(48, 52, 109)",t.DARK_GREY="rgb(78, 74, 78)",t.BROWN="rgb(133, 76, 48)",t.DARK_GREEN="rgb(52, 101, 36)",t.RED="rgb(208, 70, 72)",t.DARK_BROWN="rgb(117, 113, 97)",t.BLUE="rgb(89, 125, 206)",t.ORANGE="rgb(210, 125, 44)",t.GREY="rgb(133, 149, 161)",t.GREEN="rgb(109, 170, 44)",t.LIGHT_BROWN="rgb(210, 170, 153)",t.LIGTH_BLUE="rgb(109, 194, 202)",t.YELLOW="rgb(218, 212, 94)",t.WHITE="rgb(222, 238, 214)"}(s||(s={})),function(t){t[t.MAIN_MENU=0]="MAIN_MENU",t[t.ADVENTURE=1]="ADVENTURE",t[t.GAME_OVER=2]="GAME_OVER",t[t.GAME_WON=3]="GAME_WON"}(h||(h={}));class a{registerGameLoop(t){this._gameLoop=t}notifyGameLoop(t){this._gameLoop&&this._gameLoop.notify(t)}}class l extends a{handleInput(t){}update(){}render(){}static getInstance(){return l.instance}}l.instance=new l,function(t){t[t.ARROW_UP=0]="ARROW_UP",t[t.ARROW_DOWN=1]="ARROW_DOWN",t[t.ARROW_LEFT=2]="ARROW_LEFT",t[t.ARROW_RIGHT=3]="ARROW_RIGHT",t[t.ENTER=4]="ENTER",t[t.SPACE=5]="SPACE",t[t.NONE=6]="NONE"}(n||(n={}));class _{constructor(){this._inputs=[]}listen(){document.body.addEventListener("keyup",this.onKeyboardEvent.bind(this))}getNextInput(){let t=this._inputs.shift();return void 0===t?n.NONE:t}onKeyboardEvent(t){switch(t.key){case"ArrowUp":this._inputs.push(n.ARROW_UP);break;case"ArrowDown":this._inputs.push(n.ARROW_DOWN);break;case"ArrowLeft":this._inputs.push(n.ARROW_LEFT);break;case"ArrowRight":this._inputs.push(n.ARROW_RIGHT);break;case"Enter":this._inputs.push(n.ENTER);break;case" ":this._inputs.push(n.SPACE)}}}!function(t){t[t.START_ADVENTURE=0]="START_ADVENTURE",t[t.GAME_OVER=1]="GAME_OVER",t[t.GAME_WON=2]="GAME_WON"}(o||(o={}));class p{constructor(t){this._isOk=t.isOk,this._delegate=t.delegate}isOk(){return this._isOk}getDelegate(){return this._delegate}}class c{}class g extends c{static getInstance(){return g._instance}perform(t){return new p({isOk:!0})}}g._instance=new g;class d{constructor(t){this._position=t.position,this._glyph=t.glyph,this._actions=[],this._color=t.color||s.WHITE,this._name=t.name,this._maxHp=t.maxHp,this._hp=t.hp,this._attack=t.attack,this._defense=t.defense,this._isDead=!1,this._level=1,this._xp=0}getPosition(){return{x:this._position.x,y:this._position.y}}setPosition(t){this._position=t}getGlyph(){return this._glyph}getColor(){return this._color}pushAction(t){this._actions.push(t)}getNextAction(){return this._actions.shift()||g.getInstance()}hasAction(){return this._actions.length>0}getName(){return this._name}getHp(){return this._hp}setHp(t){this._hp=Math.min(this._maxHp,t),this._hp<0&&(this._hp=0,this._isDead=!0)}getHpMax(){return this._maxHp}getAttack(){return this._attack}getDefense(){return this._defense}isDead(){return this._isDead}getXp(){return this._xp}getNextLevelXp(){return 10*this._level}getLevel(){return this._level}addXp(t){this._xp+=t;let e=this.getNextLevelXp();this._xp>=e&&(this._xp-=e,this.levelUp())}levelUp(){this._level=Math.min(5,this._level+1),this._maxHp+=5,this._attack[0]+=this._level%2,this._attack[1]+=1,this._defense+=1-this._level%2}}const u=2147483647,x=48271;class y{constructor(t){this._seed=t}next(){return this._seed=x*this._seed%u,this._seed/u}}class w{constructor(t){this._width=t.width,this._height=t.height,this._size=this._width*this._height,this._cells=new Array(this._size).fill(0)}getCell(t){return t.x<0||t.x>=this._width?0:t.y<0||t.y>=this._height?0:this._cells[t.x+t.y*this._width]}setCell(t,e){return t.x<0||t.x>=this._width?0:t.y<0||t.y>=this._height?0:void(this._cells[t.x+t.y*this._width]=e)}getWidth(){return this._width}getHeight(){return this._height}getMin(){let t=Number.MAX_SAFE_INTEGER;return this._cells.forEach(function(e){e<t&&(t=e)}),t}getMax(){let t=Number.MIN_SAFE_INTEGER;return this._cells.forEach(function(e){e>t&&(t=e)}),t}normalize(t,e){const i=this.getMin(),r=this.getMax()-i,s=e-t;this._cells=this._cells.map(function(e){return Math.floor((e-i)*s/r+t)})}fillBox(t,e,i,r,s){for(let h=e;h<=r;h++)for(let e=t;e<=i;e++)this._cells[h*this._width+e]=s}}class m{constructor(t){this._random=new y(t.seed),this._rougthness=t.rougthness,this._max=Math.pow(2,t.detail),this._size=this._max+1,this._map=new w({width:this._size,height:this._size})}generate(){let t=this._max;for(;t>=2;){let e=t/2;for(let i=e;i<this._size;i+=t)for(let r=e;r<this._size;r+=t)this.diamondStep(i,r,t);for(let t=0;t<this._size;t+=e)for(let i=t%2?0:e;i<this._size;i+=e)this.squareStep(i,t,e);t=e}return this._map.normalize(2,7),this.createOcean(),this.createCastle(),this._map}diamondStep(t,e,i){let r=i/2,s=(this._map.getCell({x:t-r,y:e-r})+this._map.getCell({x:t+r,y:e-r})+this._map.getCell({x:t+r,y:e+r})+this._map.getCell({x:t-r,y:e-r}))/4,h=Math.floor(this._random.next()*this._rougthness*i*2-i+s);this._map.setCell({x:t,y:e},h)}squareStep(t,e,i){let r=(this._map.getCell({x:t,y:e-i})+this._map.getCell({x:t,y:e+i})+this._map.getCell({x:t+i,y:e})+this._map.getCell({x:t-i,y:e}))/4,s=Math.floor(this._random.next()*this._rougthness*i*2-i+r);this._map.setCell({x:t,y:e},s)}createOcean(){const t=this._map.getWidth(),e=this._map.getHeight();for(let i=0;i<7;i++)for(let r=0;r<t;r++){let t={x:r,y:i},s={x:r,y:e-i-1},h=this._map.getCell(t),n=this._map.getCell(s);h=Math.max(0,h-7+i),n=Math.max(0,n-7+i),this._map.setCell(t,h),this._map.setCell(s,n)}for(let i=0;i<e;i++)for(let e=0;e<7;e++){let r={x:e,y:i},s={x:t-e-1,y:i},h=this._map.getCell(r),n=this._map.getCell(s);h=Math.max(0,h-7+e),n=Math.max(0,n-7+e),this._map.setCell(r,h),this._map.setCell(s,n)}}createCastle(){this._map.fillBox(49,49,54,54,10),this._map.fillBox(65,50,68,53,10),this._map.fillBox(79,49,84,54,10),this._map.fillBox(53,51,80,52,10),this._map.fillBox(51,54,52,65,10),this._map.fillBox(49,65,54,70,10),this._map.fillBox(81,54,82,65,10),this._map.fillBox(79,65,84,70,10),this._map.fillBox(54,67,60,68,10),this._map.fillBox(60,66,63,69,10),this._map.fillBox(73,67,79,68,10),this._map.fillBox(70,66,73,69,10)}}class f{static createMap(t){return new m(t).generate()}}class E{constructor(){this._logs=[]}getMessages(t){return this._logs.slice(-5)}addMessage(t){this._logs.push(t)}}var W;!function(t){t[t.NORTH=0]="NORTH",t[t.SOUTH=1]="SOUTH",t[t.EAST=2]="EAST",t[t.WEST=3]="WEST"}(W||(W={}));class R extends c{constructor(t,e){super(),this._stage=t,this._target=e}perform(t){let e=t.getAttack(),i=Math.round(Math.random()*(e[1]-e[0])+e[0]),r=this._target.getHp(),s=this._target.getDefense(),h=Math.max(0,i-s);r-=h,this._target.setHp(r);let n=t.getName()+" hit "+this._target.getName()+" for "+h+" damage";if(this._stage.getConsole().addMessage(n),t.addXp(1),this._target.isDead()){t.addXp(2);let e=this._target.getName()+" is dead                 ";this._stage.getConsole().addMessage(e),"D"===this._target.getGlyph()&&this._stage.notifyGameLoop(o.GAME_WON)}return new p({isOk:!0})}}class A extends c{constructor(t,e){super(),this._stage=t,this._direction=e}perform(t){let e=t.getPosition();switch(this._direction){case W.NORTH:e.y-=1;break;case W.SOUTH:e.y+=1;break;case W.EAST:e.x+=1;break;case W.WEST:e.x-=1}let i,r=this.canWalk(e),s=this.canAttack(e);return r&&!s?(t.setPosition(e),i=new p({isOk:r})):i="@"===t.getGlyph()&&s?new p({isOk:!1,delegate:new R(this._stage,s)}):new p({isOk:!0}),i}canWalk(t){let e=this._stage.getMap().getCell(t);return 0!==e&&10!==e}canAttack(t){return this._stage.getActors().find(e=>{let i=e.getPosition();return i.x===t.x&&i.y===t.y})}}class M extends c{constructor(t){super(),this._stage=t}perform(t){let e=t.getHp(),i=Math.round(3*Math.random())+1;t.setHp(e+i);let r=t.getName()+" rest for "+i+" hp        ";return this._stage.getConsole().addMessage(r),new p({isOk:!0})}}class v{constructor(t){this._viewportWidth=t.viewportWidth,this._viewportHeight=t.viewportHeight,this._glyphWriter=t.glyphWriter}render(t,e){let i=this.getOffset(t,e);for(let e=0;e<this._viewportHeight;e++)for(let r=0;r<this._viewportWidth;r++){let s=t.getCell({x:i.x+r,y:i.y+e}),h=this.getGlyphOptions(s);this._glyphWriter.writeGlyph(h.glyph,4*r,6*e,h.color)}}getOffset(t,e){let i=e.getPosition(),r=Math.round(this._viewportWidth/2),s=Math.round(this._viewportHeight/2);return i.x=Math.max(i.x-r,0),i.y=Math.max(i.y-s,0),i.x=Math.min(i.x,t.getWidth()-this._viewportWidth),i.y=Math.min(i.y,t.getHeight()-this._viewportHeight),i}getGlyphOptions(t){let e,i;switch(t){case 0:e="",i=s.DARK_BLUE;break;case 1:e="",i=s.BLUE;break;case 2:e=".",i=s.YELLOW;break;case 3:case 4:e=".",i=s.GREEN;break;case 5:e=".",i=s.DARK_GREEN;break;case 6:e=".",i=s.GREY;break;case 10:e="x",i=s.GREY;break;default:e=".",i=s.GREY}return{glyph:e,color:i}}}class O{constructor(t){this._glyphWriter=t.glyphWriter,this._viewportWidth=t.viewportWidth,this._viewportHeight=t.viewportHeigth}render(t,e,i){const r=this.getPosition(e,i);t.filter(t=>{const e=t.getPosition();return e.x>=r.x&&e.x<=r.x+this._viewportWidth&&e.y>=r.y&&e.y<=r.y+this._viewportHeight},this).forEach(t=>{const e=t.getPosition(),i=e.x-r.x,s=e.y-r.y,h=t.getGlyph(),n=t.getColor();this._glyphWriter.writeGlyph(h,4*i,6*s,n)},this)}getPosition(t,e){let i=e.getPosition(),r=Math.round(this._viewportWidth/2),s=Math.round(this._viewportHeight/2);return i.x=Math.max(0,i.x-r),i.y=Math.max(0,i.y-s),i.x=Math.min(i.x,t.getWidth()-this._viewportWidth),i.y=Math.min(i.y,t.getHeight()-this._viewportHeight),i}}class T{constructor(t){this._viewportWidth=t.viewportWidth,this._viewportHeight=t.viewportHeight,this._glyphWriter=t.glyphWriter,this._position=t.position}render(t){for(let t=0;t<this._viewportWidth;t++){let e=80===t?"+":"-";this._glyphWriter.writeGlyph(e,4*(t+this._position.x),6*this._position.y)}t.getMessages(5).forEach((t,e)=>{t+="                    ",this._glyphWriter.writeText(t,this._position.x,6*(this._position.y+e+1))},this)}}class b{constructor(t){this._viewportWidth=t.viewportWidth,this._viewportHeight=t.viewportHeight,this._position=t.position,this._glyphWriter=t.glyphWriter}render(t){for(let t=this._position.y;t<this._viewportHeight;t++)this._glyphWriter.writeGlyph("|",4*this._position.x,6*t);this._glyphWriter.writeText("hero",4*(this._position.x+1),0),this._glyphWriter.writeText("LVL: "+t.getLevel()+"     ",4*(this._position.x+1),12),this._glyphWriter.writeText("XP:  "+t.getXp()+"/"+t.getNextLevelXp()+"   ",4*(this._position.x+1),18);let e=t.getAttack();this._glyphWriter.writeText("ATK: "+e[0]+"-"+e[1],4*(this._position.x+1),30),this._glyphWriter.writeText("DEF: "+t.getDefense(),4*(this._position.x+1),36),this._glyphWriter.writeText("HP:  "+t.getHp()+"/"+t.getHpMax()+"     ",4*(this._position.x+1),42)}}const H=new class{constructor(t){this._canvas=this.createCanvas(),this._graphicalContext=this.createGraphicalContext(),this._backgroundColor=t.backgroundColor,this._foregroundColor=t.foregroundColor}writeGlyph(t,e,i,s=this._foregroundColor){let h=r[t];this._graphicalContext.fillStyle=this._backgroundColor,this._graphicalContext.fillRect(e,i,4,6),this._graphicalContext.fillStyle=s;for(let t=0;t<24;t++){let r=t%4,s=Math.floor(t/4),n=h&1<<23-t;console.log(),n&&this._graphicalContext.fillRect(r+e,s+i,1,1)}}writeText(t,e,i){let r=t.length,s=e,h=i;for(let e=0;e<r;e++){let i=t.charAt(e);this.writeGlyph(i,s,h),s+=4}}createCanvas(){const t=document.createElement("canvas");return t.width=800,t.height=600,document.body.appendChild(t),t}createGraphicalContext(){const t=this._canvas.getContext("2d");if(null===t)throw new Error;return t.scale(2,2),t}}({backgroundColor:s.BLACK,foregroundColor:s.WHITE}),N=new class extends a{constructor(t){super(),this._renderer=t.renderer}handleInput(t){t===n.ENTER&&this.notifyGameLoop(o.START_ADVENTURE)}render(){this._renderer.render()}update(){}}({renderer:new class{constructor(t){this._glyphWriter=t.glyphWriter,this._viewPortHeight=t.viewportHeight,this._viewPortWidth=t.viewportWidth}render(){this._glyphWriter.writeText("Welcome back hero,",80,24),this._glyphWriter.writeText("A terrible Dragon have claimed our castle while you were overseas.",80,42),this._glyphWriter.writeText("Evil creatures are know walking upon our land.",80,48),this._glyphWriter.writeText("You must fight those monsters and win back our castle.",80,54),this._glyphWriter.writeText("Use arrow keys to move.",80,72),this._glyphWriter.writeText("Use space bar to rest.",80,78),this._glyphWriter.writeText("Press Enter to continue ...",80,96)}}({glyphWriter:H,viewportWidth:100,viewportHeight:40})}),k=new class extends a{constructor(t){super(),this._map=this.createMap(),this._hero=this.createHero(),this._actors=[this._hero],this.createEnemies(),this._console=this.createConsole(),this._renderer=t.renderer}handleInput(t){switch(t){case n.ARROW_UP:this._hero.pushAction(new A(this,W.NORTH));break;case n.ARROW_DOWN:this._hero.pushAction(new A(this,W.SOUTH));break;case n.ARROW_LEFT:this._hero.pushAction(new A(this,W.WEST));break;case n.ARROW_RIGHT:this._hero.pushAction(new A(this,W.EAST));break;case n.SPACE:this._hero.pushAction(new M(this))}}update(){this._hero.isDead()&&this.notifyGameLoop(o.GAME_OVER),this._hero.hasAction()&&(this.ia(),this._actors.forEach(t=>{let e;do{let i=(e=t.getNextAction().perform(t)).getDelegate();!e.isOk()&&i&&t.pushAction(i)}while(!e.isOk())}),this._actors=this._actors.filter(t=>!t.isDead()))}ia(){this._actors.forEach(t=>{if(!t.hasAction()){let e=t.getPosition(),i=this._hero.getPosition();if(1===Math.abs(e.x-i.x)+Math.abs(e.y-i.y))t.pushAction(new R(this,this._hero));else{let e;switch("D"===t.getGlyph()?Math.floor(2*Math.random()):Math.floor(4*Math.random())){case 0:e=W.EAST;break;case 1:e=W.WEST;break;case 2:e=W.NORTH;break;default:e=W.SOUTH}t.pushAction(new A(this,e))}}})}render(){this._renderer.render(this)}getMap(){return this._map}getHero(){return this._hero}getActors(){return this._actors}getConsole(){return this._console}createMap(){return f.createMap({seed:4242,detail:7,rougthness:.95})}createHero(){return new d({position:{x:120,y:120},glyph:"@",name:"hero",maxHp:10,hp:10,attack:[1,2],defense:0})}createConsole(){return new E}createEnemies(){for(let t=0;t<30;t++){let t={x:Math.round(108*Math.random()+10),y:Math.round(30*Math.random())+90};this._actors.push(this.createRat(t))}for(let t=0;t<20;t++){let t={x:Math.round(108*Math.random()+10),y:Math.round(30*Math.random())+60};this._actors.push(this.createGoblin(t))}for(let t=0;t<20;t++){let t={x:Math.round(108*Math.random()+10),y:Math.round(30*Math.random())+10};this._actors.push(this.createOrc(t))}this._actors.push(new d({position:{x:66,y:59},glyph:"D",name:"dragon",color:s.RED,maxHp:50,hp:50,attack:[3,6],defense:2}))}createRat(t){return new d({position:t,glyph:"r",name:"rat",color:s.GREY,maxHp:4,hp:4,attack:[1,2],defense:0})}createGoblin(t){return new d({position:t,glyph:"g",name:"goblin",color:s.BROWN,maxHp:6,hp:6,attack:[2,3],defense:0})}createOrc(t){return new d({position:t,glyph:"O",name:"orc",color:s.LIGHT_BROWN,maxHp:12,hp:12,attack:[3,4],defense:1})}}({renderer:new class{constructor(t){this._glyphWriter=t.glyphWriter,this._mapRenderer=this.createMapRenderer(),this._actorRenderer=this.createActorRenderer(),this._consoleRenderer=this.createConsoleRenderer(),this._infoRenderer=this.createInfoRenderer()}render(t){this._mapRenderer.render(t.getMap(),t.getHero()),this._actorRenderer.render(t.getActors(),t.getMap(),t.getHero()),this._consoleRenderer.render(t.getConsole()),this._infoRenderer.render(t.getHero())}createMapRenderer(){return new v({viewportWidth:80,viewportHeight:40,glyphWriter:this._glyphWriter})}createActorRenderer(){return new O({glyphWriter:this._glyphWriter,viewportWidth:80,viewportHeigth:40})}createConsoleRenderer(){return new T({glyphWriter:this._glyphWriter,viewportWidth:100,viewportHeight:10,position:{x:0,y:40}})}createInfoRenderer(){return new b({glyphWriter:this._glyphWriter,viewportWidth:20,viewportHeight:40,position:{x:80,y:0}})}}({glyphWriter:H})}),C=new class extends a{constructor(t){super(),this._renderer=t}handleInput(t){t===n.ENTER&&window.location.reload()}update(){}render(){this._renderer.render()}}(new class{constructor(t){this._glyphWriter=t}render(){this._glyphWriter.writeText("+-------------+",176,138),this._glyphWriter.writeText("|             |",176,144),this._glyphWriter.writeText("|  GAME OVER  |",176,150),this._glyphWriter.writeText("|             |",176,156),this._glyphWriter.writeText("+-------------+",176,162)}}(H)),G=new class extends a{constructor(t){super(),this._renderer=t}handleInput(t){t===n.ENTER&&window.location.reload()}update(){}render(){this._renderer.render()}}(new class{constructor(t){this._glyphWriter=t}render(){this._glyphWriter.writeText("+-------------+",176,138),this._glyphWriter.writeText("|             |",176,144),this._glyphWriter.writeText("|  You won !  |",176,150),this._glyphWriter.writeText("|             |",176,156),this._glyphWriter.writeText("+-------------+",176,162)}}(H)),S=new class{constructor(){this._currentStage=l.getInstance(),this._mainMenuStage=l.getInstance(),this._adventureStage=l.getInstance(),this._gameOverStage=l.getInstance(),this._gameWonStage=l.getInstance(),this._inputHandler=new _,this._inputHandler.listen(),this._isRunning=!1,this._intervalId=NaN}start(){this._isRunning=!0,this._intervalId=setInterval(this.tick.bind(this),20)}stop(){this._isRunning=!1,clearInterval(this._intervalId)}registerStage(t,e){switch(e.registerGameLoop(this),t){case h.MAIN_MENU:this._mainMenuStage=e,this._currentStage=this._mainMenuStage;break;case h.ADVENTURE:this._adventureStage=e;break;case h.GAME_OVER:this._gameOverStage=e;break;case h.GAME_WON:this._gameWonStage=e}}tick(){if(this._isRunning){let t=this._currentStage;t.handleInput(this._inputHandler.getNextInput()),t.update(),requestAnimationFrame(t.render.bind(t))}}notify(t){switch(t){case o.START_ADVENTURE:this.stop(),this._currentStage=this._adventureStage,this.start();break;case o.GAME_OVER:this.stop(),this._currentStage=this._gameOverStage,this.start();break;case o.GAME_WON:this.stop(),this._currentStage=this._gameWonStage,this.start()}}};S.registerStage(h.MAIN_MENU,N),S.registerStage(h.ADVENTURE,k),S.registerStage(h.GAME_OVER,C),S.registerStage(h.GAME_WON,G),S.start()}]);