(function(){function i(a){S=a;ub=1;var c=a=void 0;l=ob=0==h(0,1)?0:0==h(0,1)?90:0==h(0,1)?180:270;m=[h(8*g,n-8*g),h(8*g,o-8*g-t)];for(c=Ga[S].colorPos;c<Ga[S].colorPos+6;c+=2)a=pb.gg(c,S^2?31:63,1,1).data,Va.push("rgb("+a[0]+", "+a[1]+", "+a[2]+")");U();y.addEventListener("touchmove",function(a){a.preventDefault()});w.scrollTo(0,0);za.style.display="none"}function ha(a,c,b){k.save();k.ta(a,c);k.rotate(90*(b||1)*Math.PI/180);k.drawImage(I,0,0,32,32,0,0,32,32);k.restore()}function ia(){960<w.innerWidth&&
(Aa.style.left=(w.innerWidth-960)/2+"px");600<w.innerHeight&&(Aa.style.top=(w.innerHeight-600)/2+"px");w.onresize=ia}function U(){J^1&&(pa=E=0,m=[h(8*g,n-8*g),h(8*g,o-8*g-t)]);db=[];Wa=eb=Ba=fb=N=0;da=[];J=1;E++;qb=0;Xa=[];Ca=[];O=[];ja=[];Da=[];Ha=[];V=[];2!=S&&(T=$=0,W=-1);O[0]=Da[0]=m[0];ja[0]=Ha[0]=m[1];Da[1]=n-Da[0];Ha[1]=h(g+64,o-64-g-t);F.width=F.width;Ia.width=Ia.width;Ja.width=Ja.width;Ka.width=Ka.width;La.width=La.width;B.lineJoin=K.lineJoin=L.lineJoin="round";B.lineCap=K.lineCap=L.lineCap=
"round";u.strokeStyle=rb;u.lineWidth=z;u.lineJoin="square";u.lineCap="square";for(var a=void 0,a=100;da.length<E&&0<a;)qa(!0),a--;var c=a=void 0;if(3<E){a=1;5<E&&(a=2);10<E&&(a=3);for(c=0;c<a;c++)db.push({pos:[h(8*g,n-8*g),h(8*g,o-8*g-t)],vx:h(10,15)/10*(0.5>Math.round()?-1:1),vy:h(10,15)/10*(0.5>Math.round()?-1:1),type:h(0,1)})}Ya();p.save();p.strokeStyle=rb;p.lineWidth=2*g;p.strokeRect(0,0,n,o-t);p.restore();var b=a=void 0,e=c=void 0,d=void 0,q=void 0,f=void 0,b=void 0,a=vb[Math.floor(h(0,vb.length-
1))];v.fillStyle="#000";v.fc(0,0,n,o-t);v.ba();for(c=h(75,300);c--;)v.fillStyle="rgba(255, 255, 255, "+Math.random()+")",d=h(2*g,n-2*g),q=h(2*g,o-2*g-t),v.fc(d,q,2,1);v.fill();v.fillStyle=a;for(c=8;c--;){d=h(4*g,n-4*g);q=h(4*g,o-4*g-t);v.save();for(e=150;e--;)v.globalAlpha=0.1,b=Math.floor(e/20),f=h(-2-b,2+b)*g,b=h(-2-b,2+b)*g,v.fc(d+f,q+b,2*g,2*g);v.restore()}v.strokeStyle="#000";v.lineWidth=2*g;ra(!0,1,v);v.strokeStyle=a;v.lineWidth=11;ra(!1,0.3,v);v.strokeStyle=a;v.lineWidth=6;ra(!1,0.3,v);v.strokeStyle=
a;v.lineWidth=2;ra(!1,1,v);e=c=a=void 0;for(c=60;c--;)a={x:0,y:0,a:1,c:0},a.d=h(2,8),a.vx=2*h(-10,10),a.vy=2*h(-10,10),a.r=h(220,255),a.g=h(190,255),a.b=0,0==c%7&&(a.d=8,a.vx=h(-2,2),a.vy=h(-2,2),e=Va[1].substr(4).split(","),a.r=parseInt(e[0]),a.g=parseInt(e[1]),a.b=parseInt(e[2])),0==c%12&&(a.c=1,a.r=h(220,255),a.g=h(200,255),a.b=h(200,255),a.d=h(4,12),a.x+=h(-8,8),a.y+=h(-8,8)),Ca.push(a);aa.style.display="none";ka();gb();B.lineWidth=z;B.strokeStyle=Va[0];X&&(K.lineWidth=z-4,K.strokeStyle=Va[1],
L.lineWidth=z-8,L.strokeStyle=Va[2])}function qa(a,c,b,e,d,g,f,j){d=[h(64,n-64),h(64,o-64-t)];b=1;e=p.gg(d[0],d[1],32,32).data;for(c=e.length;c--;)if(0!=e[c]){b=0;break}b&&(f=g=0,j=-1,4<E&&da.length>h(0,Math.floor(E/4))&&(g=2*(h(-10,10)/10),f=2*(h(-10,10)/10),j=0),8<E&&da.length>h(4,Math.floor(E/2))&&(g=2*h(0,1)*(0==h(0,1)?1:-1),f=0==g?2*(0==h(0,1)?1:-1):0,j=1),12<E&&da.length>h(6,E/2)&&(g=2*(h(-10,10)/10),f=2*(h(-10,10)/10),j=3),0>j&&(g=2*(h(-10,10)/10),f=2*(h(-10,10)/10)),da.push({pos:d,vx:g,vy:f,
movetype:j,type:a?0:Math.floor(h(1,2)),state:1}))}function la(a){if(ub&&!Ba&&(J||fb)){j.clearRect(0,0,n,o);p.clearRect(g,g,n-2*g,o-t-2*g);qb&&(pa+=500+1E3*(E/50),U());T&&(T^0&&0<W)&&(W+$<Date.now()&&"charge"==Ma[sa]&&(T=0),ka());if(eb)500>Date.now()-hb?(j.save(),j.fillStyle="rgb("+h(0,255)+", "+h(0,255)+", "+h(0,255)+")",j.fc(0,0,n,o),j.restore()):qb=1,ta(!0);else{J&&(m[0]+=0==l||180==l?0:90==l?r:-r,m[1]+=90==l||270==l?0:0==l?-r:r);a=void 0;for(a=0;2>a;a++){j.save();j.globalAlpha=0.3;j.ta(Da[a],Ha[a]);
if(a^1||Wa>=E)j.globalAlpha=1,j.rotate(-5*N*Math.PI/180);Wa>=E&&(p.fillStyle="#00ff00",p.fc(Da[1]-20,Ha[1]-20,40,40));j.drawImage(C,128,0,64,64,-32,-32,64,64);j.restore()}var c=a=void 0,b=void 0,a=0==l||180==l?m[0]:90==l?m[0]-r:m[0]+r,c=90==l||270==l?m[1]:0==l?m[1]+r:m[1]-r,b=O.length;ob!=l&&(O.push(a),ja.push(c),ob=l,b=O.length,P(),ba(O[b-2],ja[b-2]),Q(O[b-1],ja[b-1]),Za(),u.ba(),u.m(O[b-2],ja[b-2]),u.l(O[b-1],ja[b-1]),u.stroke(),Na(!1));P();ba(O[b-1],ja[b-1]);Q(a,c);Za();u.ba();u.m(O[b-1],ja[b-
1]);u.l(a,c);u.stroke();X&&(B.drawImage(Ja,0,0),B.drawImage(Ka,0,0));Na(!0);j.drawImage(Ia,0,0);(1!=sa||!T||0>W)&&p.drawImage(La,0,0);a=void 0;if(0==N%60&&35>h(0,100)){for(var e=b=c=a=void 0,e=[h(64,n-64),h(64,o-64-t)],c=1,b=p.gg(e[0],e[1],32,32).data,a=b.length;a--;)if(0!=b[a]){c=0;break}c&&V.push({type:h(0,Ma.length-1),state:1,pos:e})}p.fillStyle="#f00";for(a=V.length;a--;)if(p.ba(),p.a(V[a].pos[0],V[a].pos[1],16,0,2*Math.PI),p.ca(),p.fill(),0==V[a].state){sa=c=V[a].type;T=1;W=-1;switch(Ma[c]){case "mine":$=
3;break;case "charge":$=Ga[S].chargeTime}Ea(D[Ma[c]]);ka();V.splice(a,1)}else{c=V[a].type;b=V[a].pos[0];e=V[a].pos[1];j.save();j.ta(b,e);switch(Ma[c]){case "mine":j.drawImage(C,192,32,32,32,-16,-16,32,32);break;case "charge":j.drawImage(C,224,32,32,32,-16,-16,32,32)}j.restore()}e=b=e=b=c=a=void 0;0==N%80&&40>h(10,100)&&qa();for(a=da.length;a--;)if(c=da[a],p.save(),p.ta(c.pos[0]-16,c.pos[1]-16),p.drawImage(C,96,32,32,32,0,0,32,32),p.restore(),0==c.state)da.splice(a,1),0==c.type&&Wa++,pa+=100*(c.type+
1),ka(),Wa==E&&Ea(D.portalopen,500);else{if(0==N%2){3<E&&(0==N%40&&0==h(0,1)&&1==c.movetype)&&(c.vx=0==c.vx?2*(0==h(0,1)?1:-1):0,c.vy=0==c.vy?2*(0==h(0,1)?1:-1):0);3==c.movetype&&0==N%100&&(c.pos[0]=0==h(0,1)?o-c.pos[0]:c.pos[0],c.pos[1]=0==h(0,1)?o-c.pos[1]:c.pos[1]);c.pos[0]=0.5+(c.pos[0]+c.vx*G)|0;c.pos[1]=0.5+(c.pos[1]+c.vy*G)|0;b=c.pos[0]<g/2+16;e=c.pos[0]>n-g/2-32;if(b||e)c.pos[0]=b?g/2+16:n-g/2-32,c.vx*=-1;b=c.pos[1]<g+16;e=c.pos[1]>o-g-t-16;if(b||e)c.pos[1]=b?g+16:o-g-t-16,c.vy*=-1}j.drawImage(C,
32*c.type,32,32,32,c.pos[0]-16,c.pos[1]-16,32,32)}e=b=e=b=c=a=void 0;for(c=db.length;c--;){a=db[c];p.save();p.ta(a.pos[0]-32,a.pos[1]-32);p.drawImage(C,128+64*a.type,272,64,64,0,0,64,64);p.restore();a.pos[0]=0.5+(a.pos[0]+a.vx*G)|0;a.pos[1]=0.5+(a.pos[1]+a.vy*G)|0;b=a.pos[0]<g/2+32;e=a.pos[0]>n-g/2-64;if(b||e)a.pos[0]=b?g/2+32:n-g/2-64,a.vx*=-1;b=a.pos[1]<g+32;e=a.pos[1]>o-g-t-32;if(b||e)a.pos[1]=b?g+32:o-g-t-32,a.vy*=-1;j.drawImage(C,64*a.type,272,64,64,a.pos[0]-32,a.pos[1]-32,64,64)}if(J){ta();
for(var d=void 0,q=a=c=e=b=b=a=a=void 0,i=void 0,q=e=void 0,b=0==l||180==l?m[0]-z/2:90==l?m[0]-(r-z/2):m[0]-r-(z/2-r),e=90==l||270==l?m[1]-z/2:0==l?m[1]-r-(z/2-r):m[1]-(r-z/2),q=0==l||180==l?z:r,i=0==l||180==l?r:z,a=p.gg(b,e,q,i),a=a.data,c=0,d=a.length;d--;)if(Y(a,d,255,255,0)){ib(b,e,q,i,da,"gemcollect");break}else if(Y(a,d,255,0,0)){ib(b,e,q,i,V,0);break}if(0==l)for(b=0;b<a.length;b+=4)if(Y(a,b,255,255,255)){for(b=J=0;b<a.length;b+=4)(255!=a[b]||255!=a[b+1]||255!=a[b+2])&&c++;a=Math.floor(c/z);
m[1]-=a;break}else{if(Y(a,b,0,255,0)){ua();break}}else if(90==l)for(q=0;q<r;q++){for(e=0;e<z;e++)if(b=4*(r-q)+4*e*r-4,Y(a,b,255,255,255)){J=0;break}else if(Y(a,b,0,255,0)){ua();break}if(!J){for(++q;q<r;q++)for(e=0;e<z;e++)b=4*(r-q)+4*e*r-4,(255!=a[b]||255!=a[b+1]||255!=a[b+2])&&c++;a=Math.floor(c/z);m[0]+=a;break}}else if(180==l){for(b=a.length-4;b-=4;)if(Y(a,b,255,255,255)){J=0;if(!J)for(b=a.length;b-=4;)(255!=a[b]||255!=a[b+1]||255!=a[b+2])&&c++;break}else if(Y(a,b,0,255,0)){ua();break}a=Math.ceil(c/
z);m[1]+=a}else if(270==l)for(q=0;q<r;q++){for(e=0;e<z;e++)if(b=4*q+4*e*r,Y(a,b,255,255,255)){J=0;break}else if(Y(a,b,0,255,0)){ua();break}if(!J){for(++q;q<r;q++)for(e=0;e<z;e++)b=4*q+4*e*r,(255!=a[b]||255!=a[b+1]||255!=a[b+2])&&c++;a=Math.floor(c/z);m[0]-=a;break}}J^1&&(Ea(D.explosion),hb=Date.now(),fb=1,pa>$a&&H&&H.setItem("hi",pa))}else{e=b=c=a=void 0;a=Date.now()-hb;c=m[0];b=m[1];0>c-16&&(c=0);0>b-16&&(b=0);c-16>n-32&&(c=n-32);b-16>o-32&&(b=o-32);for(q=0;q<Ca.length;q++)e=Ca[q],j.ba(),j.fillStyle=
"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")",0<e.a?e.c?(j.a(e.x+c,e.y+b,e.d,0,2*Math.PI,!0),j.f(),e.d+=0.7,e.a-=0.01):(j.fc(e.x+c,e.y+b,e.d,e.d),e.x+=e.vx,e.y+=e.vy,e.d-=0.02,e.a-=0.005):Ca.splice(q,1);1>a/500&&(j.save(),j.globalAlpha=1-a/500,j.fillStyle="#fff",j.fc(0,0,n,o),j.restore());56>Ca.length&&(fb=0,Ca=[],a=void 0,a=h(0,3),ea.innerHTML=Fa[a],ab.innerHTML=Z[a],aa.style.display="block")}}ma.drawImage(jb,0,0);N++}else if(0>G){c=a=void 0;for(c=0;960>c;c+=60)for(a=0;600>a;a+=60)f.ba(),f.a(c,a,10,
0,2*Math.PI,!0),f.fill(),f.ca();ma.save();ma.globalAlpha=0;ma.drawImage(F,0,0);ma.restore();f.ce(0,0,n,o);Date.now()<A.ellapsedTime?(A.measureCounter++,a=0):(A.measureScore=1E3*(A.measureCounter/A.measureTime),a=A.etalon/A.measureScore);a^0&&(1!=a?(G=2<a?2:a,X=1.8<G?0:1,r=0.5+wb*G|0):(G=1,r=wb),Ba=0)}void 0!=va?va(la):setTimeout(la,30)}function ka(a,c,b){ca(Oa,pa+"","0");ca(xb,E+"","0",3);Pa(kb);Pa(lb);if(T){if(1>sa){a="";kb.style.visibility="visible";for(c=0;c<$;c++)a+="+";ca(Ab,a,"+",3,1)}if(1==
sa){a="||||||||||";lb.style.visibility="visible";if(0<W){a="";b=Math.ceil(10*((W+$-Date.now())/$));for(c=0;c<b;c++)a+="|";ca(yb,a,"|",10,1)}ca(yb,a,"|",10,1)}}}function ta(a){j.save();j.ta(m[0],m[1]);j.rotate(!0==a?-15*N*Math.PI/180:l*Math.PI/180);T&&1==sa&&0<W?j.drawImage(C,32*(N%18),64+32*S,32,32,-16,-12,32,32):j.drawImage(C,32*S,0,32,32,-16,-12,32,32);j.restore();T&&(1==sa&&0<W)&&(j.save(),j.ta(m[0],m[1]),j.fillStyle="#fff",j.fillRect(24,-24,64,6),j.fillStyle="#4096ee",j.fillRect(25,-23,62*(W+
$-Date.now())/$,4),j.restore())}function Na(a,c,b){for(b=0;b<Xa.length;b++)if(c=Xa[b],c.pathIndex<O.length&&c.active){u.save();u.ba();if(!1==a&&c.pathIndex<O.length-2)c.time+2E3<Date.now()?Qa(c,Ga[S].bombRadius,b,1):B.drawImage(C,20*(N%10),192+20*S,20,20,c.pos[0]-10,c.pos[1]-10,20,20);else if(!0==a&&c.pathIndex>O.length-3||c.active)c.time+2E3<Date.now()&&c.active?Qa(c,Ga[S].bombRadius,b):B.drawImage(C,20*(N%10),192+20*S,20,20,c.pos[0]-10,c.pos[1]-10,20,20);u.ca();u.fill();u.restore()}}function Qa(a,
c,b,e,d){B.save();X&&(K.save(),L.save());P();var d=a.pos[0],g=a.pos[1];B.globalCompositeOperation=K.globalCompositeOperation=L.globalCompositeOperation="destination-out";B.fillStyle=K.fillStyle=L.fillStyle="#000";B.a(d,g,c,0,2*Math.PI);X&&(K.a(d,g,c,0,2*Math.PI),L.a(d,g,c,0,2*Math.PI));B.ca();X&&(K.ca(),L.ca());B.fill();X&&(K.fill(),L.fill());B.restore();X&&(K.restore(),L.restore());u.fillStyle="#000";u.a(a.pos[0],a.pos[1],c,0,2*Math.PI);a.sound&&(Ea(D.mineexplode),a.sound=0);a.time+3E3<Date.now()?
e&&(a.active=0,Xa.splice(b,1)):(d=Date.now()-a.time,1>d/2500&&(j.save(),j.fillStyle="#fff",j.globalAlpha=1-d/2500,j.ba(),j.a(a.pos[0],a.pos[1],0.5*Ga[S].bombRadius*(1+d/2500),0,2*Math.PI,!0),j.ca(),j.f(),j.restore()))}function Y(a,c,b,e,d){return a[c]==b&&a[c+1]==e&&a[c+2]==d}function ib(a,c,b,e,d,g,f){for(var h,j,i,k,l,m,n,o,f=0;f<d.length;f++)j=d[f].pos[0],k=d[f].pos[1],l=a,m=a+b,n=c,o=c+e,h=j-16,j+=16,i=k-16,k+=16,h>m||(j<l||i>o||k<n)||(d[f].state=0,g&&Ea(D[g]))}function mb(){switch(Ma[sa]){case "mine":Xa.push({pos:[m[0],
m[1]],time:Date.now(),pathIndex:O.length-1,active:1,sound:1});$--;break;case "charge":0>W&&(W=Date.now())}1>$&&(T=0);ka()}function sb(a,c){c=a.keyCode;32==c&&(a.preventDefault(),J&&T^0&&mb());J&&(!eb&&!Ba)&&(l=c^37&&c^39?l:37==c?0==l?270:l-90:270==l?0:l+90);80==c&&(Ba=!Ba)}function fa(a){a=a.changedTouches[0];J&&(a.clientX<(n/2-200)/w.devicePixelRatio?l=0==l?270:l-90:a.clientX>(n/2+200)/w.devicePixelRatio?l=270==l?0:l+90:T^0&&mb())}function P(){B.ba();X&&(K.ba(),L.ba())}function ba(a,c){B.m(a,c);
X&&(K.m(a,c),L.m(a,c))}function Q(a,c){B.l(a,c);X&&(K.l(a,c),L.l(a,c))}function Za(){B.stroke();X&&(K.stroke(),L.stroke())}function Ra(a,c,b,e){a.ba();a.fillStyle=e||"#e30057";a.a(c,b,16,0,2*Math.PI,!0);a.ca();a.fill();a.ba();a.fillStyle="#000";a.a(c,b,13,0,2*Math.PI,!0);a.ca();a.fill()}function R(a,c,b,e,d){a.save();a.ta(c,b);a.drawImage.apply(a,e);a.scale(-1,d||1);a.drawImage.apply(a,e);a.restore()}function Sa(a,c,b,e,d,g,f,h){a.save();a.ta(b,e);a.scale(1,-1);a.drawImage(c,d,g,f,h,0,0,f,h);a.restore()}
function ra(a,c,b,e,d,f){e=d=a?0:8.5;f=a?0:g;b.save();b.globalAlpha=c;b.ba();b.m(e+2*g,d);b.arcTo(e+n-f,d,e+n-f,d+2*g,2*g);b.m(n-f/2+0.5,d+2*g);b.arcTo(e+n-f,d+o-f-(a?g:t),e+n-f-2*g,d+o-f-(a?g:t),2*g);b.m(n-2*g-g/2,o-f/2+0.5-(a?g:t));b.arcTo(e,d+o-f-(a?g:t),e,d+o-f-2*g,2*g);b.m(e,o-2*g-g/2-(a?g:t));b.arcTo(e,d,e+2*g,d,2*g);b.stroke();b.restore()}function Ta(a,c){f.save();f.clearRect(0,0,n,o);1==a?(f.fillStyle=c||"#c96c3d",f.ba(),f.m(32,0),f.l(47,0),f.l(0,47),f.l(0,32),f.ca(),f.fill(),f.fillStyle=
c||"#ad4635",f.ba(),f.m(46,0),f.l(56,64),f.l(39,64),f.l(0,46),f.ca(),f.fill(),f.fillStyle=c||"#572a2e",f.ba(),f.m(46,0),f.l(64,48),f.l(64,57),f.l(56,64)):(f.fillStyle=c||"#c96c3d",f.ba(),f.m(35,0),f.l(0,48),f.l(0,32),f.ca(),f.fill(),f.fillStyle=c||"#ad4635",f.ba(),f.m(35,0),f.l(64,12),f.l(0,48),f.ca(),f.fill(),f.fillStyle=c||"#572a2e",f.ba(),f.m(64,12),f.l(48,64),f.l(24,64),f.l(0,48));f.ca();f.fill();f.restore()}function ca(a,c,b,d,f,g,h){g="";for(h=0;h<(d||8)-c.length;h++)g+=b;a.innerHTML=f?"<i>"+
c+"</i>"+g:g+"<i>"+c+"</i>"}function Pa(a){a.style.visibility="hidden"}function gb(){T^1&&(Pa(kb),Pa(lb));ca(Oa,"0","0");ca(xb,"1","0",3);ca(nb,$a+"",0,8)}function ua(){hb=Date.now();eb=1;m[0]=Da[1];m[1]=Ha[1]}function h(a,c){return Math.floor(Math.random()*(c-a+1)+a)}function Ea(a,c){if(0<bb)try{setTimeout(function(){Ua.src=a;Ua.play()},c||0)}catch(b){}}function Ya(){H&&($a=H.getItem("hi"));null==$a&&($a=0)}function M(a){return y.getElementById(a)}var s,y,N,A,t,va,Ua,D,bb,G,H,na,w,Aa,aa,ea,ab,Fa,
Z,x,wa,ga,zb,d,za,cb,nb,Oa,kb,Ab,lb,yb,xb,xa,v,o,n,tb,p,La,u,rb,C,k,ya,ma,Ia,Ja,Ka,B,K,L,jb,j,I,pb,F,f,vb,g,Va,z,oa,fb,Ba,eb,$a,J,E,qb,hb,X,pa,ub,db,sa,Wa,da,Ca,O,ja,m,l,ob,r,wb,S,Da,Ha,Ga,Xa,V,Ma,$,T,W;y=document;w=window;N=0;A={startTime:-1,ellapsedTime:-1,measureTime:2E3,measureCounter:0,measureScore:-1,etalon:60};t=24;va=w.requestAnimationFrame||w.mozRequestAnimationFrame||w.webkitRequestAnimationFrame||w.msRequestAnimationFrame;D=[];bb=0;G=-1;na=new sfxrSynth;Aa=M("w");aa=M("l");ea=aa.children[0];
ab=aa.children[1];Fa=["Do you like fireworks?","Ka-Boom!","Your rocket exploded.","Game Over"];Z=["Well, next time try not to cross the line ;)","Now you've learned that glowing lines are dangerous ;)","...as it was expected ;)","Better luck next time ;)"];x=aa.children[2];wa=M("p1");ga=M("p2");zb=M("p3");d=M("p4");za=M("s");cb=M("h");nb=M("hi").children[0].children[0];Oa=M("score").children[0].children[0];kb=M("bomb");Ab=kb.children[0].children[0];lb=M("charge");yb=lb.children[0].children[0];xb=
M("zone").children[0].children[0];ya=Aa.children[0];ma=ya.getContext("2d");xa=y.createElement("canvas");v=xa.getContext("2d");tb=y.createElement("canvas");p=tb.getContext("2d");La=y.createElement("canvas");u=La.getContext("2d");I=y.createElement("canvas");pb=I.getContext("2d");C=y.createElement("canvas");k=C.getContext("2d");Ia=y.createElement("canvas");Ja=y.createElement("canvas");Ka=y.createElement("canvas");B=Ia.getContext("2d");K=Ja.getContext("2d");L=Ka.getContext("2d");jb=y.createElement("canvas");
j=jb.getContext("2d");F=y.createElement("canvas");f=F.getContext("2d");n=jb.width=La.width=Ia.width=Ja.width=Ka.width=F.width=xa.width=tb.width=C.width=ya.width;o=jb.height=La.height=Ia.height=Ja.height=Ka.height=F.height=xa.height=tb.height=C.height=ya.height;rb="#fff";vb="#380000 #3a2000 #3a3d00 #003f1e #003142 #000447 #270049".split(" ");g=16;Va=[];z=12;oa=new Image;hb=qb=E=J=$a=eb=Ba=fb=0;X=1;ub=pa=0;db=[];Wa=sa=0;da=[];Ca=[];ja=O=0;m=[];ob=l=0;wb=r=3;S=0;Da=[];Ha=[];Ga={"0":{colorPos:42,bombRadius:64,
chargeTime:3E3},1:{colorPos:58,bombRadius:32,chargeTime:8E3},2:{colorPos:58,bombRadius:32,chargeTime:5E3},3:{colorPos:74,bombRadius:32,chargeTime:5E3}};Xa=[];V=[];Ma=["mine","charge"];W=T=$=0;ya.style.width=xa.style.width=n/w.devicePixelRatio+"px";ya.style.height=xa.style.height=o/w.devicePixelRatio+"px";p.lineJoin=u.lineJoin=k.lineJoin="square";p.lineCap=u.lineCap=k.lineCap="square";p.lineWidth=u.lineWidth=z;p.strokeStyle=u.strokeStyle=rb;ma.globalCompositeOperation="copy";ya.style.position=xa.style.position=
"absolute";ya.style.zIndex=2;xa.style.zIndex=1;Aa.insertBefore(xa,ya);for(s in ma)ma[s[0]+(s[6]||"")]=j[s[0]+(s[6]||"")]=B[s[0]+(s[6]||"")]=K[s[0]+(s[6]||"")]=L[s[0]+(s[6]||"")]=u[s[0]+(s[6]||"")]=v[s[0]+(s[6]||"")]=k[s[0]+(s[6]||"")]=pb[s[0]+(s[6]||"")]=f[s[0]+(s[6]||"")]=p[s[0]+(s[6]||"")]=ma[s];oa.onload=function(){I.height=F.height=oa.width;I.width=F.width=oa.height;f.ta(oa.height/2,oa.width/2);f.rotate(-90*Math.PI/180);f.ta(-oa.width/2,-oa.height/2);f.drawImage(oa,0,0);pb.drawImage(F,0,0);wa.touchstart=
function(){i(0)};wa.onclick=function(){i(0)};ga.touchstart=function(){i(1)};ga.onclick=function(){i(1)};zb.touchstart=function(){i(2)};zb.onclick=function(){i(2)};d.touchstart=function(){i(3)};d.onclick=function(){i(3)};try{Ua=new Audio,D.portalopen=na.getWave("2,0.0526,0.7984,0.1785,0.4242,0.3319,0.0535,0.3163,-0.003,0.0116,0.0551,-0.0747,0.005,0.2972,-0.0393,0.0571,0.043,-0.0287,0.9491,-0.0473,,0.0285,0.0183,0.26"),D.gemcollect=na.getWave("0,,0.0612,0.4239,0.4036,0.6456,,,,,,0.432,0.6858,,,,,,1,,,,,0.5"),
D.explosion=na.getWave("3,,0.1847,0.2125,0.4997,0.0971,,-0.0071,,,,,,,,,0.3468,-0.0407,1,,,,,0.5"),D.mineexplode=na.getWave("3,0.0212,0.2132,0.6722,0.4957,0.0725,,0.0933,0.0402,0.0327,,-0.0365,0.0411,,-0.0548,,0.0685,-0.3272,1,0.082,0.06,,0.0186,0.5"),D.mine=na.getWave("1,,0.1668,,0.4156,0.2101,,0.1847,,0.1579,0.2293,,,,,,,,1,,,,,0.5"),D.charge=na.getWave("1,,0.2328,,0.4261,0.4229,,0.2849,,,,,,,,0.4062,,,1,,,,,0.5"),bb=1}catch(a){}var c=void 0,b=void 0,e=void 0,c=[10,10,-10,-10,10,10],b=[16,32,-16,
-16,16,32],e=[32,32,-32,-32,32,32];R(k,16,16,[I,32,0].concat(b));R(k,48,16,[I,48,0].concat(b));R(k,80,16,[I,48,32].concat(b));R(k,112,16,[I,64,0].concat(b));R(k,16,48,[I,0,32].concat(b),-1);R(k,48,48,[I,16,32].concat(b),-1);R(k,80,48,[I,32,32].concat(b),-1);R(k,160,32,[I,0,0].concat(e),-1);ha(192,0);ha(128,64,-1);b=k;Ra(b,208,48);b.ba();b.fillStyle="#e30057";b.a(208,48,9,0,2*Math.PI,!0);b.ca();b.fill();b.fillStyle="#000";b.ba();b.a(208,48,6,0,2*Math.PI,!0);b.ca();b.fill();b.fillRect(205,35,6,26);
b.fillRect(195,45,26,6);b.ba();b.fillStyle="#e30057";b.a(208,48,3,0,2*Math.PI,!0);b.ca();b.fill();b=k;Ra(b,240,48,"#00fbfb");b.fillStyle="#00fbfb";b.ba();b.moveTo(239,49);b.l(234,49);b.l(243,39);b.ca();b.fill();b.ba();b.moveTo(241,47);b.l(246,47);b.l(237,57);b.ca();b.fill();b=k;b.save();b.fillStyle="#ffff00";b.ta(112,32);b.scale(0.75,1);b.rotate(45*Math.PI/180);b.fc(0,0,23,23);b.restore();R(k,306,10,[I,64,32].concat(c),1,-1);R(k,286,10,[I,74,32].concat(c),1,-1);R(k,266,10,[I,64,42].concat(c),1,-1);
R(k,326,10,[I,64,52].concat(c),1,-1);Sa(k,C,256,20,256,0,20,10);Sa(k,C,276,20,276,0,20,10);Sa(k,C,296,20,296,0,20,10);Sa(k,C,316,20,316,0,20,10);e=b=c=void 0;F.width=F.width;for(e=0;4>e;e++)for(b=0;9>b;b+=0.5)f.drawImage(C,32*e,0,32,32,0,0,32,32),f.save(),c=f.createLinearGradient(0,0,0,32),c.addColorStop(0,"rgba(78,169,244,.3)"),c.addColorStop(0.1*b,"rgba(171,211,238,.9)"),c.addColorStop(0.1*b+0.01,"rgba(137,195,235,.9)"),c.addColorStop(0.9,"rgba(54,168,249,.5)"),c.addColorStop(1,"rgba(54,168,249,0)"),
f.globalCompositeOperation="source-atop",f.fillStyle=c,f.fillRect(0,0,32,32),f.restore(),k.drawImage(F,0,0,32,32,64*b,64+32*e,32,32),F.width=F.width;b=c=void 0;k.save();k.fillStyle="#e30057";k.ta(0,192);for(b=0;4>b;b++)for(c=0;10>c;c++)k.drawImage(C,256+20*b,0,20,20,20*c,20*b,20,20),k.save(),k.globalAlpha=0.1*c,k.ba(),k.a(20*c+10,20*b+10,3,0,2*Math.PI),k.f(),k.restore();k.restore();Ta(1);k.drawImage(F,0,0,64,64,0,272,64,64);Ta(2);k.drawImage(F,0,0,64,64,64,272,64,64);Ta(1,"#fff");k.drawImage(F,0,
0,64,64,128,272,64,64);Ta(2,"#fff");k.drawImage(F,0,0,64,64,192,272,64,64);b=c=void 0;try{b=new Date,(H=w.localStorage).setItem(b,b),c=H.getItem(b)!=b,H.removeItem(b),c&&(H=!1)}catch(g){}Ya();ia();cb.style.display="block";gb();Ba=1;A.startTime=Date.now();A.ellapsedTime=A.startTime+A.measureTime;A.measureCounter=0;A.measureScore=-1;la();setTimeout(function(){w.scrollTo(0,1)},1E3);y.addEventListener("keydown",sb,!0);y.addEventListener("touchstart",fa,!0);x.onclick=U};oa.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABUCAMAAAAF8MFhAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEhQTFRFAOjXrI5grABCq3sA0poAvqd7QYwe49zIeSooRQAa31I587QACwgAcEn90MGWdQAsImExYbgL/9IA4wBXLRuE////AAAA////VEgVLAAAABh0Uk5T//////////////////////////////8AzRMu6gAABGpJREFUeNqk2Iti2yoMAFDFryTdtXF45f//9EqIlww0XUeXzU2ig4QNxoP3h+a9//ZzeP9jgx9kENs/AenoM2BsP4P02wfAWmOtHSYS/v0OsMYQIAQvlJYA0b0x2lpJyMpbAkT3RmvOwXYGscrIt4CN8TpWkQl/PY/9ElK4dnRQJ2Gtp5/hqQDRPQK6CIGI8XYkQN09xjuuoiThfedarA5BdO8CIJLwvk9kQIYzUBM+vS5EOgAZ3hFyu5yMn06mDiGEz4DxxnhBiCI+AhiPM8xgXCP8EKCRwBSMZaKqwveA19ksEKFRIdZ3cpDAeb7O8xwMooljIQUBnK8XAacsIZ1QE65qIXgBnBSvz1MSRgjeX1MA0f1La87hvAJxLH1TBNTdY7yOVWRCG90IeYEsQArXjg7qJEwt1EUEwDOQu6f1oAiBKDPDpOxzCgko4bweiCQqIAk5BfoDovs4Gesk0uS0UaiAYIAMT7O5ELoWGsB7kOGtkJeHmEIZhAh8voE/1VMZs22obb/aH0Tg7As/32AMhL/YoWxhULcPwG4H4adsw/3BPtgfxMuFzw391d8f7PtuB0IBXuHo7O0PMB6u+4MOEJlmf7BTPHAOQlBUcg3gUGYB6u4xHmIVFaEUjj8C21aAIoDoHsDRQZ2EUsq8+AwmIvyWBBDdIwBFsAwYRzHhUj7LNE3nAuruMd5xFSUJYxwDLyK2EE9TKQkguncBEEkUgAdv43gSwlsgwxmoiWcsgTqkGIrHuaVIoIJAhrfC8xkG8V0DtDJkII21mcyEI969jJXhH27dyaTUpCge2zSZ9g5dt/5sZGB4i6erwZjvnhe4dzUEep0LYOJvTFM3D/xkoTZ/BBhpibgP1S0hgSmMIRLXr2k9z/PSI+ASryKhrsCfBQn9pyEaAC9SImrB2jlVsDSFCEAFwBJRCRg/x+ClLQRo84Rp5wr4zlUEmmsELBS6zN5fCJpMUeARCDOtEvBzWGa90Jf0Ej4VBNBcCsl7fnk/CQE/d7oCrLP/RSEQEOYidk+FYzABhgV8kwBcpPSiZ7qWQwYoJICIOJN7AFaFKdDUpuGTAOXDr7gQ0PxW+DIdAJcFzCCPwRWggXAunRSn89Hlrnm7ffP0TvuTNCkTYa0gHrdbn4B0qbo88dLRvjsBrF0CKDgQjvpPR3xPACeBHoEA7bI4zvCSYvQ73uV3qIADGzKrRIBvmzoDKGAR8S5fFYGRFBuY2ggZJEFHQWmIgs0prDGD+yGJAKAgAZcBdwWO2NZbNYhReNOTNw+D430Cl/+4Pa4ZFAEoLAOO9qQBcGGrwfFflPCxHse9BqIw2OZRfBz+x5fGuNvKCYQ83P1+X6MwAKj7PRAY72jMKIMqPgswemJOF9MXAfhVBu4h/rD+SAKMn1f5COMrgBOg/b4j4FhHwIITlpLY3/QcgKHvOgMCQgb41igDNS8oEIDz7Hg8GoAzONZhBnMSfvffgeEOgMAOvwToFqBQ+DWA6/BisIZqRRi0/wUYAMYNllJQswEKAAAAAElFTkSuQmCC"})();
function sfxrParams(){this.setSettingsString=function(i){i=i.split(",");this.waveType=parseInt(i[0])||0;this.attackTime=parseFloat(i[1])||0;this.sustainTime=parseFloat(i[2])||0;this.sustainPunch=parseFloat(i[3])||0;this.decayTime=parseFloat(i[4])||0;this.startFrequency=parseFloat(i[5])||0;this.minFrequency=parseFloat(i[6])||0;this.slide=parseFloat(i[7])||0;this.deltaSlide=parseFloat(i[8])||0;this.vibratoDepth=parseFloat(i[9])||0;this.vibratoSpeed=parseFloat(i[10])||0;this.chA=parseFloat(i[11])||0;
this.changeSpeed=parseFloat(i[12])||0;this.squareDuty=parseFloat(i[13])||0;this.dutySweep=parseFloat(i[14])||0;this.repeatSpeed=parseFloat(i[15])||0;this.phaserOffset=parseFloat(i[16])||0;this.phaserSweep=parseFloat(i[17])||0;this.lpFilterCutoff=parseFloat(i[18])||0;this.lpFilterCutoffSweep=parseFloat(i[19])||0;this.lpFilterResonance=parseFloat(i[20])||0;this.hpFilterCutoff=parseFloat(i[21])||0;this.hpFilterCutoffSweep=parseFloat(i[22])||0;this.masterVolume=parseFloat(i[23])||0}}
function sfxrSynth(){this._params=new sfxrParams;var i,ha,ia,U,qa,la,ka,ta,Na,Qa,Y,ib,mb,sb,fa,P,ba,Q,Za,Ra,R,Sa,ra,Ta,ca,Pa,gb,ua,h,Ea,Ya,M,s,y,N,A,t,va,Ua,D,bb,G,H,na,w,Aa,aa,ea,ab,Fa,Z,x,wa,ga;this.reset=function(i){var d=this._params;ba=100/(d.startFrequency*d.startFrequency+0.001);Za=100/(d.minFrequency*d.minFrequency+0.001);Ra=1-0.01*d.slide*d.slide*d.slide;R=1E-6*-d.deltaSlide*d.deltaSlide*d.deltaSlide;0==d.waveType&&(h=0.5-0.5*d.squareDuty,Ea=5E-5*-d.dutySweep);Pa=0<d.chA?1-0.9*d.chA*d.chA:
1+10*d.chA*d.chA;gb=0;ua=1==d.changeSpeed?0:2E4*(1-d.changeSpeed)*(1-d.changeSpeed)+32;if(i){d.paramsDirty=!1;ha=d.masterVolume*d.masterVolume;ia=d.waveType;0.01>d.sustainTime&&(d.sustainTime=0.01);i=d.attackTime+d.sustainTime+d.decayTime;0.18>i&&(i=0.18/i,d.attackTime*=i,d.sustainTime*=i,d.decayTime*=i);sb=d.sustainPunch;fa=0;Sa=d.minFrequency;Ua=1!=d.lpFilterCutoff||0!=d.hpFilterCutoff;G=D=0;H=0.1*d.lpFilterCutoff*d.lpFilterCutoff*d.lpFilterCutoff;na=1+1E-4*d.lpFilterCutoffSweep;w=5/(1+20*d.lpFilterResonance*
d.lpFilterResonance)*(0.01+H);0.8<w&&(w=0.8);w=1-w;Aa=1!=d.lpFilterCutoff;aa=0;ea=0.1*d.hpFilterCutoff*d.hpFilterCutoff;ab=1+3E-4*d.hpFilterCutoffSweep;ra=0;Ta=0.01*d.vibratoSpeed*d.vibratoSpeed;ca=0.5*d.vibratoDepth;la=qa=U=0;ta=1E5*d.attackTime*d.attackTime;Na=1E5*d.sustainTime*d.sustainTime;Qa=1E5*d.decayTime*d.decayTime+10;ka=ta;this._envelopeFullLength=ta+Na+Qa;Y=1/ta;ib=1/Na;mb=1/Qa;s=0!=d.phaserOffset||0!=d.phaserSweep;y=1020*d.phaserOffset*d.phaserOffset;0>d.phaserOffset&&(y=-y);N=0.2*d.phaserSweep*
d.phaserSweep*d.phaserSweep;t=0;va||(va=Array(1024));Fa||(Fa=Array(32));for(i=0;1024>i;i++)va[i]=0;for(i=0;32>i;i++)Fa[i]=2*Math.random()-1;Ya=0;M=0==d.repeatSpeed?0:parseInt(2E4*(1-d.repeatSpeed)*(1-d.repeatSpeed))+32}};this.synthWave=function(ta,d,za,cb){cb=cb||44100;i=!1;for(za=ga=wa=0;za<d;za++){if(i)return za;0!=M&&++Ya>=M&&(Ya=0,this.reset(!1));0!=ua&&++gb>=ua&&(ua=0,ba*=Pa);Ra+=R;ba*=Ra;ba>Za&&(ba=Za,0<Sa&&(i=!0));Q=ba;0<ca&&(ra+=Ta,Q=ba*(1+Math.sin(ra)*ca));Q=parseInt(Q);8>Q&&(Q=8);0==ia&&
(h+=Ea,0>h?h=0:0.5<h&&(h=0.5));if(++la>ka)switch(la=0,++qa){case 1:ka=Na;break;case 2:ka=Qa}switch(qa){case 0:U=la*Y;break;case 1:U=1+2*(1-la*ib)*sb;break;case 2:U=1-la*mb;break;case 3:U=0,i=!0}s&&(y+=N,A=parseInt(y),0>A?A=-A:1023<A&&(A=1023));Ua&&0!=ab&&(ea*=ab,1E-5>ea?ea=1E-5:0.1<ea&&(ea=0.1));for(var nb=Z=0;8>nb;nb++){fa++;if(fa>=Q&&(fa-=Q,3==ia))for(var Oa=0;32>Oa;Oa++)Fa[Oa]=2*Math.random()-1;switch(ia){case 0:x=fa/Q<h?0.5:-0.5;break;case 1:x=1-2*(fa/Q);break;case 2:P=fa/Q;P=0.5<P?6.28318531*
(P-1):6.28318531*P;x=0>P?1.27323954*P+0.405284735*P*P:1.27323954*P-0.405284735*P*P;x=0>x?0.225*(x*-x-x)+x:0.225*(x*x-x)+x;break;case 3:x=Fa[Math.abs(parseInt(32*fa/parseInt(Q)))]}Ua&&(bb=D,H*=na,0>H?H=0:0.1<H&&(H=0.1),Aa?(G+=(x-D)*H,G*=w):(D=x,G=0),D+=G,aa+=D-bb,x=aa*=1-ea);s&&(va[t&1023]=x,x+=va[t-A+1024&1023],t=t+1&1023);Z+=x}Z=0.125*ha*U*Z;1<Z?Z=1:-1>Z&&(Z=-1);ga+=Z;wa++;if(44100==cb||2==wa)ga/=wa,wa=0,ta[za]=parseInt(32E3*ga),ga=0}return d}}
sfxrSynth.prototype.getWave=function(i){var ha=new Uint8Array([82,73,70,70,0,0,0,0,87,65,86,69,102,109,116,32,16,0,0,0,1,0,1,0,68,172,0,0,136,88,1,0,2,0,16,0,100,97,116,97,0,0,0,0]);this._params.setSettingsString(i);this.reset(!0);this._envelopeFullLength=parseInt(this._envelopeFullLength);var i=new Uint16Array(this._envelopeFullLength),ia=this.synthWave(i,this._envelopeFullLength,!1),U=2*ia,qa=new Uint32Array(ha.buffer);qa[1]=36+U;qa[10]=U;ha=new Blob([ha,i.subarray(0,ia-1)],{type:"audio/wav"});
return(window.URL||window.webkitURL).createObjectURL(ha)};window.sfxrSynth=sfxrSynth;sfxrSynth.prototype.getWave=sfxrSynth.prototype.getWave;