var FastBase64={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encLookup:[],Init:function(){for(var a=0;a<4096;a++){this.encLookup[a]=this.chars[a>>6]+this.chars[a&63]}},Encode:function(f){var a=f.length;var g="";var d=0;while(a>2){n=(f[d]<<16)|(f[d+1]<<8)|f[d+2];g+=this.encLookup[n>>12]+this.encLookup[n&4095];a-=3;d+=3}if(a>0){var e=(f[d]&252)>>2;var c=(f[d]&3)<<4;if(a>1){c|=(f[++d]&240)>>4}g+=this.chars[e];g+=this.chars[c];if(a==2){var b=(f[d++]&15)<<2;b|=(f[d]&192)>>6;g+=this.chars[b]}if(a==1){g+="="}g+="="}return g}};var RIFFWAVE=function(d){this.data=[];this.wav=[];this.dataURI="";this.header={chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],subChunk1Id:[102,109,116,32],subChunk1Size:16,audioFormat:1,numChannels:1,sampleRate:8000,byteRate:0,blockAlign:0,bitsPerSample:8,subChunk2Id:[100,97,116,97],subChunk2Size:0};function b(e){return[e&255,(e>>8)&255,(e>>16)&255,(e>>24)&255]}function a(e){return[e&255,(e>>8)&255]}function c(k){var h=[];var f=0;var e=k.length;for(var g=0;g<e;g++){h[f++]=k[g]&255;h[f++]=(k[g]>>8)&255}return h}this.Make=function(e){if(e instanceof Array){this.data=e}this.header.blockAlign=(this.header.numChannels*this.header.bitsPerSample)>>3;this.header.byteRate=this.header.blockAlign*this.sampleRate;this.header.subChunk2Size=this.data.length*(this.header.bitsPerSample>>3);this.header.chunkSize=36+this.header.subChunk2Size;this.wav=this.header.chunkId.concat(b(this.header.chunkSize),this.header.format,this.header.subChunk1Id,b(this.header.subChunk1Size),a(this.header.audioFormat),a(this.header.numChannels),b(this.header.sampleRate),b(this.header.byteRate),a(this.header.blockAlign),a(this.header.bitsPerSample),this.header.subChunk2Id,b(this.header.subChunk2Size),(this.header.bitsPerSample==16)?c(this.data):this.data);this.dataURI="data:audio/wav;base64,"+FastBase64.Encode(this.wav)};if(d instanceof Array){this.Make(d)}};FastBase64.Init();window.onload=function(){window.app={};app.local_storage=function(){return"localStorage" in window&&window.localStorage!==null?true:false};app.load_cfg=function(a){var b=localStorage.getItem(a);if(!app.local_storage||!b){return false}return JSON.parse(b)};app.save_cfg=function(a,b){if(!app.local_storage){return false}localStorage.setItem(a,JSON.stringify(b))};app.create_cv=function(f,a,c,d,e){var b={};!app.cv?app.cv={}:"";b.cv=document.createElement("canvas");b.cv.width=a;b.cv.height=c;b.ctx=b.cv.getContext("2d");if(d){app.cv[f]=b}if(e){document.getElementById("cvs").appendChild(b.cv);b.cv.setAttribute("width",a);b.cv.setAttribute("height",c);b.cv.setAttribute("id",f);b.cv.setAttribute("class","cv")}return b};app.init_cv=function(f,b,a,c,d,e){if(b){app.create_cv(f,a,c,d,e)}else{app.cv[f].cv=document.getElementById(f);if(!app.cv[f].cv||!app.cv[f].cv.getContext){return false}else{app.cv[f].ctx=app.cv[f].cv.getContext("2d")}}};app.gen_sfx_data=function(a,h,d,c){var g=[];var e;for(var b=0;b<a+d;b++){if(b>=a){g[b]=128;continue}e=(b<h)?b/h:((b>=a-h)?1-(b-a+h-1)/h:1);g[b]=Math.round(128+c(b)*e)}return g};app.gen_audio_elem=function(c){var a=new RIFFWAVE(c);var b=new Audio(a.dataURI);return b};app.play_sfx=function(a){if(app.url_params.sfx==0){return false}app.sfx[a].play()};app.fps_tout_fn=function(){app.last_fps=app.fps;app.fps=0};app.grant_achv=function(f,e,d,c){var b=app.achv;b[f][0]+=c;clearTimeout(app[f+"_tout"]);if(b[f][0]===e){app.toggle_bool(f+"_medal",3000,true);b[f][0]=0;b[f][1]+=1;app.play_sfx("exp_1")}else{app.set_timeout(f+"_tout",function(){b[f][0]=0},d)}};app.toggle_bool=function(a,f,e,d,g){d===undefined?d=app:"";e===undefined?e=false:"";d[a]=e;clearTimeout(d[a+"_tout"]);d[a+"_tout"]=setTimeout(function(){d[a]=e?false:true;if(g){g()}},f)};app.set_timeout=function(a,c,b){app[a+"_tout"]=setTimeout(c,b)};app.init_frnz_assets=function(){if(app.url_params.gore===1){app.draw_level(app.cv.frenzy_bg.ctx);var h=app.cv.frenzy_bg.ctx.getImageData(0,0,app.w,app.h);var c=h.data;var f=c.length;var g=app.cv.frenzy_bg.ctx.createImageData(app.w,app.h);var b=g.data;for(var e=0;e<f;e+=4){b[e]=c[e];b[e+1]=0;b[e+2]=0;b[e+3]=255}app.cv.frenzy_bg.ctx.putImageData(g,0,0)}};app.init_noise=function(){if(app.url_params.noise===1){var i=app.create_cv("pat_cv",240,240);var f=i.ctx;var g;var d;app.noise_frames=[];app.crnt_noise_frame=0;app.noise_rate=0;for(var b=0;b<16;b+=1){f.clearRect(0,0,i.cv.width,i.cv.height);for(var e=0;e<i.cv.height;e+=6){for(var h=0;h<i.cv.width;h+=6){if(Math.random()<0.5){g=Math.random()/2;d=Math.round(Math.random()*64);f.fillStyle="rgba("+Math.round(Math.random()*30)+","+Math.round(Math.random()*30)+","+Math.round(Math.random()*30)+","+g+")";f.fillRect(h,e,6,6)}}}app.noise_frames.push(app.cv.noise.ctx.createPattern(i.cv,"repeat"))}}};app.draw_noise=function(a){if(app.url_params.noise===1){if(app.noise_rate===1){app.noise_rate=0;a.clearRect(0,0,app.w,app.h);a.fillStyle=app.noise_frames[app.crnt_noise_frame];a.fillRect(0,0,app.w,app.h);app.crnt_noise_frame=app.crnt_noise_frame+1===app.noise_frames.length?0:app.crnt_noise_frame+1}else{app.noise_rate+=1}}};app.create_obj=function(b,e){var d;var a=new app[b]();if(app[a.type+"_id"].length>0){d=app[a.type+"_id"].pop()}else{d=app[a.type].length}a.id=d;e?e(a):"";app[a.type][d]=a;return a};app.remove_obj=function(a){app[a.type+"_id"].push(a.id);delete app[a.type][a.id]};app.update_bot_track=function(d,c){var a=app.bot_track;a.spawn[d]+=c?1:0;a.kill[d]+=c?0:1;a.alive[d]+=c?1:-1;a.alive_count+=c?1:-1};app.spawn_bot=function(c){var d=app.create_obj("Bot");var b=Math.random()>0.5?0:1;d.b_t=c||0;d.dir=b;d.dx_max+=app.wave*0.3;if(Math.random()>0.7){d.x=Math.random()*app.w;d.y=-d.h/2}else{d.y=Math.random()*app.h;d.x=-d.w/2}for(var a in app.bot_types[c]){d[a]=app.bot_types[c][a]}d.anim="bot_walk_"+app.bot_types[c].skin+"_1";app.update_bot_track(c,true)};app.update_player=function(){var a=app.plr;if(a.left||a.right){a.anim="player_run_"+a.skin}else{a.anim="player_idle_"+a.skin}a.update_pos();a.update_anim_frame();a.move();a.update_jump();a.start_fall();a.lvl_pads_coll();a.lvl_bnds_coll();a.update_phs();a.bots_coll();a.update_grab();a.update_attack();a.update_hp()};app.set_screen_shake=function(a,b){if(!app.shake_tout){app.shake=true;app.shake_d=b||2;clearTimeout(app.shake_tout);app.shake_tout=setTimeout(function(){app.shake=false;delete app.shake_tout},a)}};app.action_mngr=function(){var a=0;if(!app.can_spawn||app.wave_break||app.bot_track.alive_count>=app.max_bot_count+Math.min(app.wave_tmr/15,10)){return false}app.toggle_bool("can_spawn",app.bot_spawn_delay);if(app.bot_track.alive[0]<Math.max((app.wave/2.2)-(app.wave/4)*(app.wave/app.wave_peak),2)||app.wave<1){a=0}else{app.bot_chances.forEach(function(c,b){if(Math.random()<c){a=b+1}})}app.spawn_bot(a)};app.on_wave_start=function(){app.plr.dx_max<15?app.plr.dx_max+=1:"";app.max_bot_count=Math.floor(app.wave*app.bot_count_fn[0]+app.bot_count_fn[1]);app.bot_spawn_delay=(Math.max(125,1500-app.wave*150));app.bot_chances_fn.forEach(function(b,a){app.bot_chances[a]=b[0]*(app.wave/app.wave_peak)+b[1]});app.wave_tmr=0};app.update=function(){var c=app.plr;app.fps+=1;switch(app.game_state){case -1:break;case 0:break;case 1:app.tmr+=0.033;app.wave_tmr+=0.033;app.update_player();app.bot.forEach(function(a){if(a.can_move||app.plr.is_grab===false||app.plr.is_grab!==a.id){a.move();a.lvl_pads_coll();a.lvl_bnds_coll();a.update_phs();a.update_jump();a.update_pos()}else{a.lvl_pads_coll()}a.php=a.hp;a.hp+=a.dhp;if(a.dhp<0){a.sht_p("Blood",a.x,a.y,0,Math.PI*2,15,-a.dhp*(app.plr.frenzy?2:4),-a.dhp)}if(a.hp<=0){if(this.can_move&&this.pad_coll===false){app.update_hud_msg("aerial killer!!!")}c.update_kill_ct();a.destroy()}else{a.dhp=0}if(a.b_t!==0){a.anim=a.anim.slice(0,a.anim.length-1)+(Math.random()>0.5?1:2)}a.update_anim_frame()});app.blood.forEach(function(a){a.update_phs();a.update_pos()});app.body_part.forEach(function(a){a.update_phs();a.update_pos();a.lvl_pads_coll();a.update_anim_frame()});if(app.shake===true){app.shake_x=-6*app.shake_d+app.round(Math.random()*6*app.shake_d+6);app.shake_y=-6*app.shake_d+app.round(Math.random()*6*app.shake_d+6)}else{app.shake_x=0;app.shake_y=0}if(app.shake){app.cvs.style.top=app.shake_y+"px";app.cvs.style.left=app.shake_x+"px"}app.cv.frenzy_bg.cv.style.zIndex=1;app.cv.frenzy_bg.cv.style.opacity=(app.plr.frenzy?3:0)*(Math.random()*0.3+0.1);if(app.plr.frenzy_end!==false){app.cv.frenzy_bg.cv.style.opacity=1;app.wave+=1;app.on_wave_start()}if(app.plr.frenzy&&!app.frenzy_sfx&&app.url_params.sfx){app.frenzy_sfx=setInterval(function(){if(app.plr.frenzy){app.play_sfx("frenzy")}else{delete app.frenzy_sfx}},100)}app.action_mngr();break;case 2:if(!app.b_sum){app.b_sum=[];for(var b=0;b<4;b+=1){app.spawn_bot(b);app.b_sum[b]=app.bot[app.bot.length-1];app.b_sum[b].x=0;app.b_sum[b].y=0}}else{app.bot.forEach(function(a){a.update_anim_frame(true)})}if((c.left||c.right||c.jump||c.down)&&!app.summary_menu_select_tout){app.select_smr_m(true);app.toggle_bool("summary_menu_select_tout",300,true)}if(app.smr_hvr_y&&c.attack&&!app.smr_active_tout){app.smr_hvr_x?app.tweet_score():app.restart_game()}break}};app.num_to_roman=function(k){if(k>=100){return false}var h="";var f="";var j;var b;var e;b=k>=10?Math.floor(k/10):0;k-=b*10;e=k;var g={x:b,i:e};if(g.x){if(g.x===10){h="c"}else{if(g.x===9){h+="xc"}else{if(g.x>5){h+="l";g.x-=5}if(g.x>3){f="";g.x-=3;for(var d=0;d<g.x;d+=1){f="x"+f}f+="l";h+=f}else{for(var d=0;d<g.x;d+=1){h="x"+h}}}}}if(g.i){if(g.i===9){h+="ix"}else{if(g.i>4){h+="v";g.i-=5;for(var d=0;d<g.i;d+=1){h+="i"}}else{if(g.i===4){h+="iv"}else{for(var d=0;d<g.i;d+=1){h+="i"}}}}}return h};app.draw_text=function(j,e,i,g,m,k,f,d){var b;e=e+"";!m?m=0:"";!k?k=0:"";f?f=e.length*8*6*(d?4:1)/2:f=0;j.save();j.translate(app.round(i-f),app.round(g));for(var h=0;h<e.length;h+=1){b=app.cv["f_"+e[h]+(d?"_roman_big":"")].cv;h>0?j.translate(b.width+6,0):"";j.drawImage(b,app.round(-m/2+Math.random()*m*6),app.round(-k/2+Math.random()*k*6))}j.restore()};app.draw_hud_msg=function(b,c,a){if(app.msg.length>0){app.msg.forEach(function(e,d){app.draw_text(b,e,app.round(app.w/2-e.length*8*6/2),app.round(app.h/8)+12+d*6*10,c||0,a||0)})}};app.reset_game_stngs=function(){app.tmr=0;app.wave=0;app.wave_tmr=0;app.wave_break=false;app.shake=false;app.can_spawn=true;app.ckill=false;app.ckill_pts_buff=0;app.ckill_count=0;app.ckill_max_count=0;app.ckill_max_pts=0;app.achv={crusher:[0,0],feeder:[0,0],grinder:[0,0]};app.bot=[];app.bot_id=[];app.bot_track={kill:[0,0,0,0],spawn:[0,0,0,0],alive:[0,0,0,0],alive_count:0};app.bot_types=[{skin:"normal",dmg:0,dx_max:10,hp:100},{skin:"green",dmg:0.47,dx_max:11,hp:125},{skin:"red",dmg:1,dx_max:12,hp:150},{skin:"blue",dmg:1.5,dx_max:13,hp:175}];app.blood=[];app.blood_id=[];app.blood_buff=[];app.body_part=[];app.body_part_id=[];app.plr=new app.Plr();app.plr.x=app.w/2;app.plr.y=app.h/2;app.bot_chances=[]};app.update_hud_msg=function(a){if(a!==""){app.msg.push(a);if(app.msg.length>1){app.msg.shift()}}clearTimeout(app.msg_tout);app.msg_tout=setTimeout(function(){if(app.msg.length>0){app.msg.shift();app.update_hud_msg("")}},3000)};app.draw_start_screen=function(a){a.save();a.translate(0,app.h/2-4*6);app.draw_text(a,"press j to start",app.w/2,0,2,2,true);a.restore()};app.draw_hud=function(b){var a=app.w-60;var d=app.round(a/3);var c=app.round(a/4);b.save();b.translate(30,30);b.drawImage(app.cv.h_heart.cv,0,0);b.fillStyle=app.plr.pdhp&&app.plr.pdhp!==0&&Math.random()>0.5?"#fff":"#f00";b.fillRect(11*6,0,app.round((d-15*6)*(app.plr.hp/100)),6*8);b.translate(d,0);b.drawImage(app.cv.h_score.cv,0,0);app.draw_text(b,Math.floor(app.plr.score*(app.wave+1)),10*6,0);b.translate(d,0);b.drawImage(app.cv.h_skull.cv,0,0);app.draw_text(b,Math.floor(app.plr.kill_count),8*6,0);b.translate(d/2,0);b.drawImage(app.cv.h_tmr.cv,0,0);app.draw_text(b,Math.floor(app.tmr),10*6,0);b.restore();app.draw_hud_msg(b,2,2);if(!app.plr.frenzy){if(app.plr.pdhp<-0.36){b.fillStyle="rgba(255,0,0,"+Math.random()/3+")"}else{b.fillStyle="rgba(0,0,0,"+Math.random()*0.2+")"}}else{b.fillStyle="rgba("+255+",0,0,"+0.2*Math.random()+")"}b.fillRect(0,0,app.w,app.h);if(app.wave_break){b.save();b.translate(0,80);app.draw_text(b,"wave",app.w/2,app.h/2-190,2,2,true);app.draw_text(b,app.num_to_roman(app.wave+1),app.w/2,app.h/2,4,4,true,true);b.restore()}else{if(app.plr.frenzy_start){app.draw_text(b,"kill frenzy!!!",app.w/2,app.h/2+70,2,2,true)}else{if(app.ckill_record_msg){app.draw_text(b,"combo "+app.ckill_max_count+" kills ("+app.ckill_max_pts+"pts)",app.w/2,app.h/2+70,2,2,true)}else{if(app.crusher_medal){app.draw_achv(b,"crusher")}else{if(app.feeder_medal){app.draw_achv(b,"feeder")}else{if(app.grinder_medal){app.draw_achv(b,"grinder")}}}}}}};app.draw_achv=function(a,b){app.draw_text(a,b+"! (x"+app.achv[b][1]+")",app.w/2,app.h/2+70,2,2,true)};app.round=function(a,b){return a-a%(b||6)};app.draw=function(b){var d=app.plr;var a=app.level;var c;b.fillStyle="#000";b.clearRect(0,0,app.w,app.h);switch(app.game_state){case -1:app.draw_start_screen(b);break;case 0:app.draw_text(b,app.intro_msg[0]+" (j)",app.w/2,app.h/2-4*6,2,2,true);break;case 1:b.fillStyle="#000";b.clearRect(0,0,app.w,app.h);b.fillStyle="#fff";app.bot.forEach(function(e){b.save();if(e.dir===0){b.scale(-1,1);b.translate(app.round(-2*e.x),0)}b.translate(app.round(e.x-e.sw/2),app.round(e.y-e.sh/2));if(!e.can_move){b.rotate(3*Math.PI/2);b.translate(-e.sw,0)}e.draw_anim_frame(b,0,0);b.restore()});app.body_part.forEach(function(e){b.save();if(e.dir===0){b.scale(-1,1);b.translate(app.round(-2*e.x),0)}b.translate(app.round(e.x-e.sw/2),app.round(e.y-e.sh/2));e.draw_anim_frame(b,e.sw/2,e.sh/2);b.restore()});app.blood.forEach(function(e){b.fillStyle="rgb("+(128+Math.floor(Math.random()*128))+", 0, 0)";b.fillRect(app.round(e.x),app.round(e.y),e.w,e.h)});b.save();if(d.dir===0){b.scale(-1,1);b.translate(app.round(-2*d.x),0)}b.translate(app.round(d.x-d.sw/2),app.round(d.y-d.sh/2));if(d.frenzy||d.pdhp<-0.9){d.anim=d.anim.split("_frenzy_")[0]+("_frenzy_white_"+(Math.random()>0.5?1:2))}else{d.anim=d.anim.split("_frenzy_")[0]+"_frenzy_white_1"}d.draw_anim_frame(b,0,0);b.restore();app.draw_hud(b);app.draw_gore_fx(app.cv.gore.ctx);app.draw_level(app.cv.bg.ctx);break;case 2:app.draw_summary(b);b.fillStyle="#fff";if(app.smr_hvr_y){b.fillStyle="rgba(255,0,0,"+(0.2+Math.random()*0.4)+")";b.fillRect(app.smr_hvr_x,app.smr_hvr_y,app.w/2,60)}break}app.draw_noise(app.cv.noise.ctx)};app.draw_level=function(b,d){var c;var a=app.level;if(b.level_layer&&!d){return false}b.level_layer=true;b.clearRect(0,0,app.w,app.h);b.save();c=b.createPattern(app.cv.wall_1.cv,"repeat");b.fillStyle=c;b.fillRect(0,0,app.w,app.h);a.pads.forEach(function(j,e){var g=app.round(j.w);var i=a.pad_h;b.save();b.translate(app.round(j.x),app.round(j.y));c=b.createPattern(app.cv.pad_1.cv,"repeat");b.fillStyle="#000";b.fillRect(6*2,6*2,g,i);for(var f=0;f<g;f+=6){b.fillRect(f,i,1*6,Math.floor(Math.random()*10)*6)}b.fillStyle=c;b.fillRect(0,0,g,i);b.restore()});b.restore()};app.draw_gore_fx=function(a){if(app.url_params.gore===1){app.blood_buff.forEach(function(b){if(b.x>0&&b.y>0&&b.x<app.w&&b.y<app.h&&Math.random()<0.25){a.drawImage(app.cv.frenzy_bg.cv,app.round(b.x),app.round(b.y),6,6,app.round(b.x),app.round(b.y),6,6)}});app.blood_buff=[]}};app.draw_summary=function(a){a.save();a.fillStyle="#000";a.fillRect(0,0,app.w,app.h);a.translate(app.round(app.w/2),30);app.draw_text(a,"game over!:(",0,0,2,2,true);a.translate(0,120);app.draw_text(a,"rank:#"+Math.floor(app.plr.rank)+" score:"+app.plr.score,0,0,2,2,true);app.draw_text(a,"time:"+Math.floor(app.tmr)+" wave:"+(app.wave+1),0,60,2,2,true);app.draw_text(a,"kills:"+app.plr.kill_count,0,120,2,2,true);a.translate(-app.w/2,180);if(app.b_sum){app.b_sum.forEach(function(c,b){a.save();a.translate(b*((app.w-60)/6)+app.w/4-48,0);c.draw_anim_frame(a);app.draw_text(a,app.bot_track.kill[b],60,0,2,2);a.restore()})}a.translate(app.w/2,-120);app.draw_text(a,"combo "+app.ckill_max_count+" kills ("+app.ckill_max_pts+"pts)",0,180,2,2,true);app.draw_text(a,("crusher:"+app.achv.crusher[1])+(" feeder:"+app.achv.feeder[1]),0,240,2,2,true);app.draw_text(a,("grinder:"+app.achv.grinder[1]),0,300,2,2,true);a.translate(0,120);app.draw_text(a,"play again : tweet score",0,300,2,2,true);a.restore()};app.loop=function(){app.update();app.draw(app.cv.sucker.ctx)};app.save_h_score=function(a){app.h_scores.push(a)};app.end_game=function(){var a=1;var b=app.plr;b.score=b.score*(app.wave+1);this.game_state=2;app.h_scores.forEach(function(c){if(c.score>b.score){a+=1}});b.rank=a;clearInterval(b.move_sfx);clearInterval(b.frenzy_sfx);if(a===1){app.clr_keys();app.smr_hvr_y=0;app.prompt_tout=setTimeout(function(){b.name=prompt("New best! Enter your name");app.save_h_score({name:b.name||"unnamed",score:b.score,kills:b.kill_count,kill_types:app.bot_track.kill,time:app.tmr,ckill_max_count:app.ckill_max_count,ckill_max_pts:app.ckill_max_pts,achv:app.achv});app.save_cfg("sucker_hs",app.h_scores)},50)}app.toggle_bool("smr_active_tout",2000,true,app,app.clr_keys())};app.pause=function(){clearInterval(app.loop_interval);delete app.loop_interval};app.start=function(){if(!app.loop_interval){app.loop_interval=setInterval(app.loop,33)}};app.load_sfx=function(){app.sfx={};app.sfx_data={footstep_1:{fn:function(c){return Math.round(Math.random()*8)},d:400},footstep_2:{fn:function(c){return Math.round(Math.random()*10)},d:400},footstep_3:{fn:function(c){return Math.round(Math.random()*6)},d:400},hurt:{fn:function(c){return Math.round(((c/32)%2===0?1:-1)*16)},d:200},jump:{fn:function(c){return Math.round(Math.cos((Math.PI/2)*(c/1200))*Math.sin(c/(10-5*(c/1200)))*32)},d:1200},idle_attack:{fn:function(c){return Math.round(((Math.sin(c/1000)>0?1:-1)*Math.random()*2+Math.sin(c/128)*2)*Math.sin((Math.PI*4/800)*c)*2)},d:400},grab:{fn:function(c){return Math.round(Math.sin((c/(32-16*(c/1000)))*(Math.PI))*32+Math.random()*2*Math.sin(Math.PI*(c/1000)+Math.PI/6))},d:1000},feed:{fn:function(c){return Math.round(Math.sin(Math.PI*(c/500))*Math.sin(c/(10-5*(c/500)))*32)},d:400},exp_1:{fn:function(c){return Math.round(Math.sin((c/(32-16*(c/4000)))*(Math.PI))*32*Math.sin(Math.PI*(c/(4000/5))))},d:4000},pad_hit_1:{fn:function(c){return Math.round(Math.sin((Math.PI*2)*((c+Math.random())/(20+(20*c/250))))*64+Math.random()*4)},d:250},frenzy:{fn:function(c){return Math.round(Math.cos(Math.PI/2*(c/1000))*Math.cos(c/(2-1*(c/1000)))*4+Math.cos(c/20)*Math.sin(Math.PI*2*(c/1000))*64)+Math.round((Math.sin(Math.PI*(c/1000/2))*Math.sin(c/(10-5*(c/1000/2)))*32)*Math.sin(Math.PI*2*(c/1000)))},d:1000}};for(var a in app.sfx_data){var b=app.gen_sfx_data(app.sfx_data[a].d,100,100,app.sfx_data[a].fn);app.sfx[a]=app.gen_audio_elem(b)}};app.restart_game=function(){app.game_state=1;app.reset_game_stngs();app.on_wave_start();app.cv.gore.ctx.clearRect(0,0,app.w,app.h)};app.parse_score=function(d){var e="";var c;d+="";c=d.length;for(var b=0;b<c;b+=3){e=","+d.slice(Math.max(d.length-3,0))+e;d=d.slice(0,Math.max(d.length-3,0))}return e.slice(1)};app.tweet_score=function(){var b=window.location.href;var c="https://twitter.com/intent/tweet?hashtags=js13kGames&original_referer="+b+"&source=tweetbutton&text=I%20scored%20"+app.parse_score(app.plr.score)+"%20points%20over%20"+(app.wave+1)+"%20wave"+(app.wave>0?"s ":"")+"%20in%20%22The%20Sucker%22%20game%2C%20a%20js13kGames%20entry%20-%20&url=http%3A%2F%2Fether-wp.com%2Fdistillery%2Fsucker%2F&via=pordesign";var a=window.open(c,"","height=600,width=800")};app.select_smr_m=function(a){var b=app.plr;if(a||app.my>624&&app.my<684){app.smr_hvr_y=624;app.smr_hvr_x=a?(app.smr_hvr_x?0:app.w/2):(app.mx>app.w/2?app.w/2:0)}};app.img_from_data=function(j,l,i){var e;var m;var f;var a=j[0];var o=j[2];var c=j[1].split(" ");var g=o?app.gfx_subtypes[o]:{df:"df"};!l?l=1:"";!i?i=1:"";m=c[0].length*6*l;f=c.length*6*i;for(var b in g){e=app.create_cv(a+(b!=="df"?"_"+b:""),m,f,true);c.forEach(function(p,k){var h=p.length;for(var d=0;d<h;d+=1){e.ctx.fillStyle=b!=="df"?(c[k][d]==="e"?g[b]:app.gfx_pal[c[k][d]]):app.gfx_pal[c[k][d]];e.ctx.fillRect(d*6*l,k*6*i,6*l,6*i)}})}};app.load_gfx=function(){app.gfx_subtypes={player:{frenzy_white_1:"rgba(255,255,255,1)",frenzy_white_2:"rgba(255,0,0,1)"},bot:{normal_1:"rgba(141,128,101,1)",green_1:"rgba(213,133,18,1)",green_2:"rgba(171,79,24,1)",red_1:"rgba(200,0,0,1)",red_2:"rgba(255,77,33,1)",blue_1:"rgba(40,129,175,1)",blue_2:"rgba(203,89,228,1)"}};app.gfx_data=[["h_heart","011101110 112111111 121111111 111111111 011111110 001111100 000111000 000010000"],["h_vial","111111 012110 012110 012110 012110 012110 011110 001100"],["h_skull","011110 112111 121111 100100 101101 011011 000010 000110"],["h_tmr","01111110 11211111 12111111 11110001 11101111 11101111 11101111 01111110"],["h_wave","00011010 00210010 00110010 10010210 11110110 00111111 01100100 01001000"],["h_score","00010000 00011000 00121000 11221111 01111110 00111100 01101100 01000100"],["f_ ","00000000"],["f_0","011110 011110 110011 110011 110011 110011 011110 011110"],["f_1","011100 001100 001100 001100 001100 001100 001100 001100"],["f_2","011110 011110 110011 110111 000110 011000 111111 111111"],["f_3","011100 011100 000011 001111 001100 000011 011111 011100"],["f_4","110000 110000 110000 110110 110110 111111 111111 000110"],["f_5","111110 111110 110000 111110 011110 000011 111111 111110"],["f_6","011110 011110 110000 111110 111110 110011 110011 011110"],["f_7","111110 111110 000110 011110 011000 011000 111000 110000"],["f_8","011110 011110 110011 111111 011110 110011 111111 011110"],["f_9","011110 011110 110011 111111 011111 000011 011111 011110"],["f_a","0111110 1110111 1110111 1111111 1110111 1110111 1110111"],["f_b","1111110 1110111 1110111 1111110 1110111 1110111 1111110"],["f_c","0111110 1110111 1110000 1110000 1110000 1110111 0111110"],["f_d","1111110 1110111 1110111 1110111 1110111 1110111 1111110"],["f_e","0111111 1110111 1110000 1111100 1110000 1110111 0111111"],["f_f","0111111 1110111 1110000 1111100 1110000 1110000 1110000"],["f_g","0111110 1110111 1110000 1110111 1110111 1110111 0111110"],["f_h","1110111 1110111 1110111 1111111 1110111 1110111 1110111"],["f_i","1111111 0011100 0011100 0011100 0011100 0011100 1111111"],["f_j","1111111 0000111 0000111 0000111 0000111 1110111 1111110"],["f_k","1110111 1110111 1110111 1111110 1110111 1110111 1110111"],["f_l","1110000 1110000 1110000 1110000 1110000 1110111 0111111"],["f_m","1100011 1110111 1111111 1111111 1110111 1110111 1110111"],["f_n","1111110 1110111 1110111 1110111 1110111 1110111 1110111"],["f_o","0111110 1110111 1110111 1110111 1110111 1110111 0111110"],["f_p","1111110 1110111 1110111 1111110 1110000 1110000 1110000"],["f_q","0111110 1110111 1110111 1110111 1110111 0111110 0000111"],["f_r","1111110 1110111 1110111 1111111 1111110 1110111 1110111"],["f_s","0111111 1110111 1110000 0111110 0000111 1110111 1111110"],["f_t","1111111 0011100 0011100 0011100 0011100 0011100 0011100"],["f_u","1110111 1110111 1110111 1110111 1110111 1110111 0111110"],["f_w","1110111 1110111 1110111 1110111 1111111 1110111 1100011"],["f_v","1110111 1110111 1110111 1110111 1110111 0111110 0011100"],["f_x","1110111 1110111 0111110 0011100 0111110 1110111 1110111"],["f_y","1110111 1110111 1111111 0111111 0000111 1110111 1111110"],["f_z","1111111 1110111 0000111 0111110 1110000 1110111 1111111"],["f_!","0001100 0001100 0001100 0001100 0001100 0000000 0001100"],["f_+","0000000 0001100 0001100 0111111 0001100 0001100 0000000"],["f_(","0001100 0011000 0110000 0110000 0110000 0011000 0001100"],["f_)","0110000 0011000 0001100 0001100 0001100 0011000 0110000"],["f_:","0000000 0000000 0011000 0000000 0000000 0011000 0000000"],["f_?","0011110 0110011 0000011 0000110 0001100 0000000 0001100"],["f_.","0000000 0000000 0000000 0000000 0000000 0110000 0110000"],["f_,","0000000 0000000 0000000 0000000 0011000 0011000 0110000"],["f_'","0001100 0000100 0001000 0000000 0000000 0000000 0000000"],["f_#","0000000 0110110 1111111 0110110 0110110 1111111 0110110"],["pad_1","45669459 5789n89n 889n33n3 9n334679 679n6793 9nn39n33"],["wall_1","bc3i3cci33c3c33c c3c3c3cb3c3i3c33 3i3c3ciic3i3i3i3 c3c3c3cb3c3c3c3c 3c3iccchccc3c3c3 c3c3c3kbbk333i3c 3c33ckbcimm3c3c3 c33icbiccccc3c3c 3ccb3mic3cbllcc3 cmcmlbc33ic33cmc 33cicccmcmb3c3c3 3c33cm3cbb3c333c c3ic33cklc33c33i 3c3c3icbc3c33c33 33i3c3ch3i3i33c3 i33c3ccbc3c3c33c"],["player_run","00000000000000e00000000e0000000000000000e000000000e000 00000e0000000ee0000000ee00000000e000000ee00000000ee000 000eee0e00000ee000000eee000000eee0e0000eee0000000ee000 00eee0e000000ee0000000eee0000e0eee0000eee00000000ee000 0000e00000000e00000000ee0000000ee000000e000000000ee000 000ee00000000ee000000ee0e000000e0000000ee0000000ee0e00 0ee00e000000eee000000e00e00000eee00000eee0000000e00e00 000000e0000000e00000e00e0000ee000e000000e000000e000000 000000e0000000e00000e000000000000e000000e000000e000000","player"],["player_idle","00000000000000e000 00000e0000000e0000 0000e0000000eee000 000eee00000e0e0e00 00e0e0e000000e0000 0000e00000000e0000 000e0e000000e0e000 000e0e000000e0e000 000e00e00000e00e00","player"],["bot_walk","000000000000e000000e0000000000e00000 00000e000000e0000000e000000000e00000 0000e0000000e000000eeee0000000e00000 000ee000000eee0000e0e000000000ee0000 000e0e00000ee00000e0e000000000e00000 000e00000000e00000000e00000000e00000 00e0e0000000e00000000ee000000ee00000 00e00e0000000e000000e00000000e0e0000 00000e0000000e000000e00000000e00e000","bot"],["body_part_1","0f0000f0000f000f0000e0000e0000e0000e0000f000 0e000e0000e00ee0ee000e0000e00e0000e0f0000e00 0e000e000e00e00000ef00e000e00e00fe000ee000e0 0e00e000e00000000000000f00f0f0000000000e00e0","bot"],["body_part_2","0000000000000000 0f0000f000000e00 0e000e000ef000f0 0000000000000000","bot"],["body_part_3","0000000000000000 0f000ff00ff000f0 0ff00f0000f00ff0 0000000000000000","bot"]];app.gfx_pal={0:"rgba(0, 0, 0, 0)",1:"rgba(255, 0, 0, 1)",2:"rgba(255, 244, 195, 1)",3:"rgba(0, 0, 0, 1)",4:"rgba(132, 132, 112, 1)",5:"rgba(114, 115, 100, 1)",6:"rgba(87, 89, 77, 1)",7:"rgba(69, 71, 61, 1)",8:"rgba(50, 50, 40, 1)",9:"rgba(35, 35, 28, 1)",b:"rgba(28, 24, 17, 1)",c:"rgba(11, 8, 6, 1)",h:"rgba(35, 33, 28, 1)",i:"rgba(24, 20, 17, 1)",k:"rgba(43, 37, 30, 1)",l:"rgba(23, 20, 16, 1)",m:"rgba(23, 20, 13, 1)",n:"rgba(15, 15, 12, 1)",e:"rgba(138, 138, 138, 1)",f:"rgba(129, 0, 0, 1)"};app.gfx_data.forEach(function(a){app.img_from_data(a);switch(a[0]){case"f_x":case"f_i":case"f_v":a[0]+="_roman_big";app.img_from_data(a,4,4);break}})};app.init_keys=function(){app.kdwn_ct=0;window.onkeydown=function(a){if(!app.k_pressed||app.k_pressed===false){switch(a.keyCode){case 38:case 87:app.plr.jump=true;break;case 83:case 40:case 76:case 90:case 32:app.plr.down=true;break;case 74:case 67:app.plr.attack=true;break;case 37:case 65:app.plr.left=true;break;case 39:case 68:app.plr.right=true;break;case 88:case 75:app.plr.grab=true;break}}app.kdwn_ct+=1};window.onkeyup=function(a){switch(a.keyCode){case 38:case 87:app.plr.jump=false;break;case 83:case 40:case 76:case 90:case 32:app.plr.down=false;break;case 37:case 65:app.plr.left=false;break;case 39:case 68:app.plr.right=false;break;case 74:case 67:if(app.game_state===-1){app.game_state=0}else{if(app.game_state===0){app.intro_msg.shift();app.play_sfx("jump");if(app.intro_msg.length===0){app.game_state=1;app.toggle_bool("wave_break",3000,true)}}}app.plr.attack=false;break;case 88:case 75:app.plr.grab=false;break}app.kdwn_ct-=1}};app.clr_keys=function(){var a=["left","right","jump","down","attack","grab"];a.forEach(function(b){app.plr[b]=false})};app.init_mouse=function(){window.onmousemove=function(a){app.prev_mx=app.mx||0;app.prev_my=app.my||0;app.mx=a.pageX;app.my=a.pageY;app.mxd=app.prev_mx-app.mx;app.myd=app.prev_my-app.my;if(app.game_state===2){app.select_smr_m()}};window.onclick=function(a){var b=app.plr;if(app.game_state===2){if(app.my>624&&app.my<684){if(app.mx<app.w/2){app.restart_game()}else{app.tweet_score()}}}};window.onblur=function(){app.clr_keys();app.pause()};window.onfocus=function(){app.start()}};app.update_url=function(){var b=window.location.href.split("?")[0]+"?";for(var a in app.url_params){b+=a+"="+app.url_params[a]+"&"}b=b.slice(0,b.length-1);window.location.href=b};app.init_html_menu=function(){var c=[["sfx","sound"],["noise","noise"],["gore","gore layer"]];var e=9;var d=document.m.b_lvl;for(var b=0;b<=e;b+=1){d.options[b]=new Option(b+(b===3?" (default)":""),b,false,b===app.url_params.blood_level?true:false)}c.forEach(function(f){var a=document.getElementById("t_"+f[0]);a.onclick=function(){if(app.game_state===1){if(!confirm("Sure?")){return false}}app.url_params[f[0]]=app.url_params[f[0]]?0:1;a.innerHTML=f[1]+" "+(app.url_params[f[0]]==true?"on":"off");app.update_url()};a.innerHTML=f[1]+" "+(app.url_params[f[0]]==true?"on":"off")});d.onchange=function(){app.url_params.blood_level=d.selectedIndex;app.update_url()};document.getElementById("i").innerHTML="WSAD/ARROWS - move, J/C - feed, K/X - grab, fall - S/DOWN/SPACE, jump - W/UP"};app.content_loaded=function(){return true};app.update_url_params=function(){var a;app.url_params={sfx:1,noise:1,gore:1,blood_level:3};if(window.location.href.indexOf("?")!==-1){str=window.location.href.split("?")[1].split("&").forEach(function(b){a=b.split("=");if(app.url_params[a[0]]){app.url_params[a[0]]=a[1]*1==a[1]?a[1]*1:a[1]}})}};app.load_content=function(){app.load_content_start=true;app.load_gfx();if(app.url_params.sfx==1){app.load_sfx()}};app.close_overlay=function(){document.getElementById("l").style.display="none"};app.init_app=function(){if(!app.load_content_start){app.update_url_params();app.init_html_menu();app.load_content();app.l_ct_intrvl=setInterval(function(){if(app.content_loaded()){app.init_app();app.close_overlay();clearInterval(app.l_ct_intrvl)}},50)}else{app.w=1278;app.h=720;app.cv_list=["bg","frenzy_bg","gore","sucker","noise"];app.cv_list.forEach(function(a){app.init_cv(a,true,app.w,app.h,true,true)});app.cvs=document.getElementById("cvs");app.init_noise();app.fps=0;app.game_state=-1;app.ckill_msg=["double","triple","quadruple","quintuple","sextuple","septuple","octuple","nonuple","decuple","undecuple","duodecuple"];app.intro_msg=["hello.. stranger!","your objective..","kill, eat and score!",];app.lp=120;app.level={w:app.w,h:app.h,pads:[{x:(app.w/9),y:0,w:(app.w/9)*3-32},{x:(app.w/9)*5+32,y:0,w:(app.w/9)*3},{x:-app.lp,y:app.h/2,w:(app.w/9)*2+app.lp},{x:app.w/3,y:app.h/2,w:app.w/3},{x:(app.w/9)*7,y:app.h/2,w:(app.w/9)*2+app.lp},{x:-app.lp,y:app.h-36,w:(app.w/9)*4+app.lp},{x:(app.w/9)*5,y:app.h-36,w:(app.w/9)*4+app.lp}],pad_h:36};app.wave_peak=20;app.bot_count_fn=[1,2];app.bot_chances_fn=[[0.66,0.15],[0.88,-0.3],[1.15,-0.75]];app.reset_game_stngs();app.msg=[];app.init_keys();app.init_mouse();app.init_frnz_assets();app.on_wave_start();app.start();app.play_sfx("jump");app.h_scores=app.load_cfg("sucker_hs")||[];app.fps_tout=setInterval(app.fps_tout_fn,1000)}};app.Coll_Obj=function(){this.x=app.w/2;this.y=app.h/2;this.w=42;this.h=54;this.dx=0;this.dy=0;this.dx_max=10;this.dy_max=18;this.pad_coll=false;this.bounce=0;return this};app.Coll_Obj.prototype.proj_out_y=function(d,a){var c=app.level;var b=d.y+c.pad_h/2-this.y;if(b>0){this.y=d.y-this.h/2;this.reload_jump();this.pad_coll=a;if(this.type==="player"&&this.dy>=18){app.play_sfx("pad_hit_1");app.set_screen_shake(80*(this.dy>36?3:1),2*(this.dy>36?2:1));this.dy>36?this.bot_coll.forEach(function(e){e.special_kill(1)}):""}if(this.type==="bot"&&!this.can_move&&app.plr.is_grab.id!==this.id){if(this.dy>26){this.special_kill(0);app.play_sfx("pad_hit_1")}else{this.can_move=true}}}else{this.y=d.y+c.pad_h+this.h/2;if(this.type==="bot"&&(!this.can_move&&this.dy<-10)){this.special_kill(0);app.play_sfx("pad_hit_1")}if(this.type==="player"){app.play_sfx("pad_hit_1");app.set_screen_shake(80);this.disable_keep_jump()}}this.dy=Math.abs(-this.dy*this.bounce)>2?-this.dy*this.bounce:0};app.Coll_Obj.prototype.lvl_pads_coll=function(){var b=app.level;var a=false;this.pad_coll=false;px_min=this.x-this.w/2;px_max=this.x+this.w/2;py_min=this.y-this.h/2;py_max=this.y+this.h/2;px_min_prev=px_min-this.dx;px_max_prev=px_max-this.dx;py_min_prev=py_min-this.dy;py_max_prev=py_max-this.dy;b.pads.forEach(function(f,c){var e;var d;if(a===true){return false}if((py_min<f.y&&py_max>f.y||py_min<f.y+b.pad_h&&py_max>f.y+b.pad_h)&&(px_min>f.x&&px_min<f.x+f.w||px_max>f.x&&px_max<f.x+f.w)){if(px_min>f.x&&px_max<f.x+f.w){this.proj_out_y(f,c)}else{if(px_min<f.x){if(px_max_prev<=f.x){if(this.type==="bot"&&this.dx>this.dx_max){this.special_kill(0)}this.x=f.x-this.w/2;this.dx=0}else{this.proj_out_y(f,c)}}else{if(px_max>f.x+f.w){if(px_min_prev>=f.x+f.w){if(this.type==="bot"&&this.dx<-this.dx_max){this.special_kill(0)}this.x=f.x+f.w+this.w/2;this.dx=0}else{this.proj_out_y(f,c)}}}}a=true}},this)};app.Coll_Obj.prototype.lvl_bnds_coll=function(){var b=this;var a=app.level;b.out_of_level_bounds=false;if(b.x<0-b.w/2){b.out_of_level_bounds=true;b.x=a.w+b.w/2}else{if(b.x>a.w+b.w/2){b.out_of_level_bounds=true;b.x=-b.w/2}}if(b.y<0+36){b.out_of_level_bounds=true;if(b.type==="player"){b.y=36;this.disable_keep_jump();this.dy=0}}else{if(b.y>a.h+b.h/2){b.out_of_level_bounds=true;b.y=-b.h/2}}};app.Coll_Obj.prototype.bots_coll=function(){this.bot_coll=[];app.bot.forEach(function(b,a){if(Math.abs(this.x-b.x)<this.sw&&Math.abs(this.y-b.y)<this.sh){this.bot_coll.push(b)}},this);if(!this.is_grab){this.b_0=this.bot_coll[0]}};app.Coll_Obj.prototype.start_fall=function(){if(this.down===true){this.disable_keep_jump()}};app.Coll_Obj.prototype.start_jump=function(){if(this.jump===true&&this.jump_lock===false&&this.pad_coll!==false){this.jump_lock=true;app.play_sfx("jump")}};app.Coll_Obj.prototype.keep_jump=function(){if(this.jump===true&&this.jump_lock===true){if(this.jump_duration<this.jump_time){this.jump_duration+=1;this.dy-=this.jump_force}}else{if(this.jump===false&&this.jump_lock===true){this.jump_duration=this.jump_time}}};app.Coll_Obj.prototype.disable_start_jump=function(){if(this.jump===true&&this.jump_lock===false){this.jump_lock=true}};app.Coll_Obj.prototype.disable_keep_jump=function(){if(this.jump_lock===true){this.jump_duration=this.jump_time*2}};app.Coll_Obj.prototype.reload_jump=function(){if(this.jump_lock===true){this.jump_lock=false;this.jump_duration=0}};app.Coll_Obj.prototype.update_jump=function(){if(this.type==="player"){this.start_jump();this.keep_jump()}else{if(this.type==="bot"){if(this.pad_coll!==false){if(Math.random()>(0.995-(0.025*app.wave/app.wave_peak))){this.dy-=26+(5*app.wave/app.wave_peak)}}}}};app.Coll_Obj.prototype.update_anim_frame=function(a){if(Math.abs(this.dx)<0.5&&Math.abs(this.dy)<0.5&&this.type!=="player"&&!a){return false}this.anim_interval+=1;if(this.anim_interval===this.anim_rate){frame_count=Math.round(app.cv[this.anim].cv.width/this.sw);this.anim_frame=this.anim_frame>=frame_count-1?0:this.anim_frame+1;this.anim_interval=0}};app.Coll_Obj.prototype.draw_anim_frame=function(b,a,c){a===undefined?a=this.x:"";c===undefined?c=this.y:"";b.drawImage(app.cv[this.anim].cv,this.anim_frame*this.sw,0,this.sw,this.sh,a,c,this.sw,this.h)};app.Coll_Obj.prototype.move=function(){var a;switch(this.type){case"player":if(this.left||this.right){this.is_moving=true;this.on_move(this.left?0:1);a=(this.dx_max*(this.move_duration/this.move_time));this.dx=Math.min(a,this.dx_max)*(this.dir?1:-1)}else{this.is_moving=false;this.move_duration=0}break;case"bot":a=this.dx_max/2;if(this.can_move===true){if(this.pad_coll!==false){this.dir===0?a=-a:"";Math.abs(this.dx)<this.dx_max/4?this.dx+=a:""}else{this.do_random_dir=true}if(this.do_random_dir!=="undefined"&&this.do_random_dir===true){if(this.pad_coll!==false){this.do_random_dir=false;this.dir=Math.random()>0.4?(this.dir?0:1):this.dir}}}break}};app.Coll_Obj.prototype.update_phs=function(){if(this.pad_coll===false){if(this.type==="player"&&this.left===false&&this.right===false){this.dx=this.dx*0.94}else{if(this.type==="bot"){this.dx=this.dx*0.99}}if(this.jump_lock===true&&this.jump===true&&this.jump_duration!==0&&this.jump_duration<this.jump_time&&this.dy<0){this.dy_max=36}else{if(this.down===true){this.dy_max=42}else{this.dy_max=18}this.dy<this.dy_max||this.type!=="player"?this.dy+=2.5*(this.down?2:1):this.dy=this.dy_max}if(this.type==="bot"){if(this.can_move){this.dy>this.dy_max?this.dy=this.dy_max:""}else{this.dy>this.h-10?this.dy=this.h-10:"";this.dy<-(this.h-10)?this.dy=-(this.h-10):""}}else{if(this.type==="player"){this.dy<-this.dy_max?this.dy=-this.dy_max:""}}}else{if(this.left===false&&this.right===false||this.type!=="player"){this.dx=this.dx*0.6;if(Math.abs(this.dx)<0.2){this.dx=0}}if(this.jump===false||this.type==="bot"){this.dy=2.8}}};app.Coll_Obj.prototype.update_pos=function(){this.x+=this.dx;this.y+=this.dy};app.Coll_Obj.prototype.destroy=function(){if(this.type!=="player"){app[this.type+"_id"].push(this.id);delete app[this.type][this.id]}if(this.on_destroy){this.on_destroy()}};app.Coll_Obj.prototype.sht_p=function(m,q,o,d,e,i,j,k,l){var h;var j=j+Math.floor(Math.random()*k||0);var b;var g;this.dir!==undefined?(this.dir===1?d=-d:""):"";d-=Math.PI/2;if(m==="Blood"){if(app.url_params.blood_level===0){return false}else{if(app.url_params.blood_level!==3&&app.url_params.blood_level<10){j=j*app.url_params.blood_level/3;k=j*app.url_params.blood_level/3}}}for(var p=0;p<j;p+=1){b=d-e/2+Math.random()*e;g=i*(Math.random()+0.3);h=app.create_obj(m,l);h.x=q;h.y=o;h.dx+=Math.cos(b)*g;h.dy+=Math.sin(b)*g-g/2}};app.Plr=function(){this.rank=0;this.type="player";this.dir=1;this.w=22;this.sw=54;this.sh=54;this.hp=30;this.dhp=0;this.skin="frenzy_white_1";this.anim="player_run_frenzy_white_1";this.anim_frame=0;this.anim_rate=3;this.anim_interval=0;this.jump_time=13;this.jump_duration=0;this.jump_force=8;this.jump_lock=false;this.grab_rld=false;this.bot_coll=[];this.frenzy=false;this.frenzy_start=false;this.frenzy_end=false;this.kill_count=0;this.move_time=10;this.move_duration=0;this.is_grab=false;this.score=0;return this};app.Plr.prototype=new app.Coll_Obj();app.Plr.prototype.update_grab=function(){if(this.grab===true&&this.grab_rld===false){if(!this.is_grab&&this.b_0){this.b_0.can_move=false;this.is_grab=this.b_0;app.toggle_bool("grab_rld",300,true,this);app.play_sfx("grab")}else{if(this.is_grab){this.is_grab=false;this.throw_item(this.b_0);app.toggle_bool("grab_rld",300,true,this);app.play_sfx("grab")}else{if(!this.b_0&&!this.frenzy){app.play_sfx("idle_attack")}}}}if(this.is_grab){this.b_0.x=this.x+(this.dir===0?1:-1);this.b_0.y=this.y-this.h/2-6;this.b_0.dx=this.dx;this.b_0.dy=this.dy;this.b_0.dir=this.dir}};app.Plr.prototype.throw_item=function(a){a.dx+=this.dx+(this.dir===0?-1:1)*10+app.wave/2*(this.frenzy?2:1);a.dy+=(this.frenzy?3:1)*-15+this.dy;a.dy<-a.h?a.dy=-a.h:""};app.Plr.prototype.on_move=function(a){var c=this;this.last_dir=this.dir;this.dir=a;this.dir===this.last_dir?(this.move_duration<this.move_time?this.move_duration+=1:""):this.move_duration=0;if(c.pad_coll!==false&&app.url_params.sfx&&!c.frenzy){var b="footstep_"+Math.ceil(Math.random()*2.99);if(c.move_duration<2){app.play_sfx(b)}if(!c.move_sfx&&!c.frenzy){c.move_sfx=setInterval(function(){if(c.is_moving&&c.pad_coll!==false&&!c.frenzy&&!c.attack){app.play_sfx(b)}else{clearInterval(c.move_sfx);delete c.move_sfx}},240)}}};app.Plr.prototype.update_attack=function(){if(this.attack&&this.b_0){this.b_0.dhp-=this.frenzy?20:3.5;if(this.b_0.hp-this.b_0.dhp<0&&this.is_grab){delete this.is_grab}this.dhp+=this.frenzy?0:(this.b_0.b_t!==0?0.5:1)*0.45;app.play_sfx("feed")}else{if(this.attack&&!this.frenzy){app.play_sfx("idle_attack")}}};app.Plr.prototype.update_kill_ct=function(){this.kill_count+=1;this.is_grab=false};app.Plr.prototype.update_hp=function(){var a;if(this.frenzy){this.dhp-=0.24;if(this.hp<30){this.frenzy=false;app.toggle_bool("frenzy_end",1,true,this,function(){app.toggle_bool("wave_break",3000,true)})}this.sht_p("Blood",this.x,this.y,Math.PI/4,Math.PI/4,40,5,10)}else{if(this.hp>100){this.hp=100;this.frenzy=true;app.toggle_bool("frenzy_start",1500,true,this)}else{if(this.hp>0){if(this.b_0&&!app.wave_break){this.bot_coll.forEach(function(b){this.dhp-=b.dmg;if(b.dmg>0){app.play_sfx("hurt")}},this)}if(this.hp>30){this.dhp-=0.024}}else{app.end_game()}}}this.hp+=this.dhp;this.pdhp=this.dhp;this.dhp=0};app.Plr.prototype.update_stats=function(a){app.ckill_count+=1;app.ckill_pts_buff+=(10+5*a.b_t)*(1+app.wave/5)*app.ckill_count;app.ckill_count>1?app.update_hud_msg(((app.ckill_count<=app.ckill_msg.length?app.ckill_msg[app.ckill_count-2]+" kill!":(app.ckill_count)+" killstreak!"))+" (+"+app.ckill_pts_buff+"pts)"):"";app.plr.score+=(10+5*a.b_t)*(1+app.wave/5)*app.ckill_count;app.toggle_bool("ckill",2500,true,app,function(){if(app.ckill_count>app.ckill_max_count){app.ckill_max_count=app.ckill_count;if(app.ckill_count>1){app.toggle_bool("ckill_record_msg",app.wave_break?5000:3000,true);app.play_sfx("exp_1")}}app.ckill_pts_buff>app.ckill_max_pts?app.ckill_max_pts=app.ckill_pts_buff:"";app.ckill_count=0;app.ckill_pts_buff=0})};app.Bot=function(){this.type="bot";this.dhp=0;this.hp=100;this.anim="bot_walk";this.anim_frame=0;this.anim_rate=3;this.anim_interval=0;this.sw=54;this.sh=54;this.dir=0;this.is_attacked=false;this.can_move=true;this.dy_max=16;this.dx_max=10;return this};app.Bot.prototype=new app.Coll_Obj();app.Bot.prototype.on_destroy=function(){var a=this;if(!app.plr.frenzy){app.plr.dhp+=(-this.dhp)/4.5+(4*this.b_t)}if(this.dhp>-21){app.grant_achv("feeder",2,2500,this.dhp<-10?0.2:1)}this.sht_p("Blood",this.x,this.y,0,Math.PI*2,30,app.plr.frenzy?200:100,100);this.sht_p("Body_Part",this.x-this.dx,this.y-this.dy,0,Math.PI*2,15,8,3,function(b){b.dir=Math.floor(Math.random()*2);b.anim="body_part_"+Math.ceil(Math.random()*3)+"_"+app.bot_types[a.b_t].skin+"_1";b.timer_events.forEach(function(c){!b.timers?b.timers=[]:"";b.timers.push(setInterval(c[1],c[0]))});b.on_destroy=function(){b.timers.forEach(function(c){clearInterval(c)})}});app.set_screen_shake(150);app.plr.update_stats(this);app.update_bot_track(this.b_t,false);app.play_sfx("exp_1")};app.Bot.prototype.special_kill=function(a){if(a===0){this.dhp-=75*(app.plr.frenzy?2:1);app.grant_achv("crusher",3,1250,1)}else{if(a===1){if(this.can_move){this.dx+=(this.x<app.plr.x?-1:1)*10;this.dy-=20;this.pad_coll=false;this.y-=5}this.dhp-=75*(app.plr.frenzy?2:1);app.grant_achv("grinder",3,1250,1)}}};app.Blood=function(){var a=this;this.type="blood";this.w=6;this.h=6;this.destroy_timeout=setTimeout(function(){app.blood_buff.push({x:a.x,y:a.y});a.destroy()},100+Math.random()*750)};app.Blood.prototype=new app.Coll_Obj();app.Body_Part=function(){var a=this;this.type="body_part";this.w=24;this.h=24;this.sw=24;this.sh=24;this.anim="body_part_1";this.anim_frame=0;this.anim_rate=3;this.anim_interval=0;this.bounce=0.5;this.timer_events=[[30,function(){a.sht_p("Blood",a.x,a.y,0,Math.PI,10,1,1)}]];this.destroy_timeout=setTimeout(function(){a.destroy()},1500+Math.random()*2000)};app.Body_Part.prototype=new app.Coll_Obj();app.init_app()};